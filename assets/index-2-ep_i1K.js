const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/SimpleEditor-C9ZXTa3f.js","assets/react-MSu_GSUq.js","assets/froala-BSJra1Lq.js","assets/froala-CEphu8CV.css","assets/react-niSHVoSi.css","assets/SimpleEditor-B3WgNbCz.css"])))=>i.map(i=>d[i]);
import{j as e,L as me,u as te,a as z,r as m,N as O,U as xe,S as ge,b as se,c as re,d as J,e as A,_ as he,f as ae,g as fe,E as ne,P as oe,T as le,C as pe,h as be,l as q,i as ye,k as ve,m as je,n as we,o as ie,B as Ne,R as ke,p as _,Q as Ce,q as Se,s as $e,t as Ee,v as Le}from"./react-MSu_GSUq.js";import"./froala-BSJra1Lq.js";(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const l of r)if(l.type==="childList")for(const i of l.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function o(r){const l={};return r.integrity&&(l.integrity=r.integrity),r.referrerPolicy&&(l.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?l.credentials="include":r.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function n(r){if(r.ep)return;r.ep=!0;const l=o(r);fetch(r.href,l)}})();const ce="http://localhost:8000";async function Y(t,a,o={}){const n=await t(),l={...o.headers||{},Authorization:`Bearer ${n}`};return!Object.keys(l).some(c=>c.toLowerCase()==="content-type")&&!(o.body instanceof FormData)&&(l["Content-Type"]="application/json"),await fetch(a,{...o,headers:l})}async function _e({getToken:t,postId:a,signal:o}){if(!a)throw new Error("postId is required");const n=`${ce}/api/posts/${a}`,r=await Y(t,n,{signal:o});if(!r.ok){const l=await r.text().catch(()=>"");throw new Error(`Fetch post failed: ${r.status} ${l||""}`)}return r.json()}async function Pe({getToken:t,postId:a,payload:o}){if(!a)throw new Error("postId is required");const n=`${ce}/api/posts/${a}`,r=await Y(t,n,{method:"PATCH",body:JSON.stringify(o)});if(!r.ok){const l=await r.text().catch(()=>"");throw new Error(`Save failed: ${r.status} ${l||""}`)}return r.json()}async function Ae({getToken:t,formData:a,endpoint:o}){if(!a)throw new Error("formData is required");const r=await Y(t,o,{method:"POST",body:a});if(!r.ok){const l=await r.text().catch(()=>"");throw new Error(`Upload failed: ${r.status} ${l||""}`)}return r.json()}function Z(t=""){return t.toString().trim().toLowerCase().replace(/\s+/g,"-").replace(/[^\w-]+/g,"").replace(/--+/g,"-").replace(/^-+/g,"").replace(/-+$/,"")}function V(t,a,o="",n="",r={},l=""){const i=(N="")=>String(N).replaceAll("&","&amp;").replaceAll("<","&lt;").replaceAll(">","&gt;").replaceAll('"',"&quot;"),d=i(t||"Preview"),c=i(n||""),f=i(l||"Date will be added here"),g=r.hMargin||"12px";typeof r.bgOpacity=="number"?r.bgOpacity:parseFloat(r.bgOpacity||"0.95");const p=r.titleWeight||"700";return`<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>${d}</title>

  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=BBH+Sans+Hegarty:wght@400;700&family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">

  <style>
    :root{
      --page-bg: rgba(0, 0, 0, 0.95);
      --link-color: #da7756;
      --muted-color: #9fb0c8;
      --text-color: #ffffff;
      --page-padding: 28px;
      --h-margin: ${g};
      --content-max-width: 1000px;
    }
    
    html {
      background-color: #1a1a1a;
    }

    html, body {
      height: 100%;
      margin: 0;
      padding: 0;
      background: var(--page-bg);
      color: var(--text-color);
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
      font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
    }

    .page {
      box-sizing: border-box;
      min-height: 100%;
      padding: var(--page-padding);
      display: flex;
      justify-content: center;
    }

    .reader {
      width: 100%;
      max-width: var(--content-max-width);
      margin: 0 auto;
    }

    h1 {
      margin: 0 0 6px 0;
      font-family: "BBH Sans Hegarty", system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
      font-weight: ${p};
      letter-spacing: -0.01em;
      font-size: clamp(22px, 3.2vw, 36px);
      color: var(--text-color);
      text-align: center;
    }

    .creation-date {
      text-align: center;
      font-family: "Roboto", system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
      font-size: 0.9rem;
      color: var(--muted-color);
      margin-bottom: 18px;
      letter-spacing: 0.02em;
    }

    h2, h3, h4, h5, h6 {
      font-family: "Roboto", system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
      font-weight: 500;
      margin-top: 1.2em;
      margin-bottom: 0.5em;
      text-align: center;
      color: var(--text-color);
    }

    .content {
      margin-top: 18px;
      line-height: 1.6;
      color: var(--text-color);
      text-align: justify;
    }

    .content a, a {
      color: var(--link-color);
      text-decoration: underline;
    }

    .cover-wrapper {
      margin: 12px auto;
      padding-left: var(--h-margin);
      padding-right: var(--h-margin);
      text-align: center;
    }

    .cover {
      display: block;
      width: calc(100% - (var(--h-margin) * 2));
      max-height: 60vh;
      height: auto;
      margin: 0 auto;
      border-radius: 8px;
      object-fit: cover;
      box-shadow: 0 6px 18px rgba(0,0,0,0.6);
    }

    .caption {
      margin-top: 6px;
      color: var(--muted-color);
      font-size: 0.9rem;
      font-style: italic;
      text-align: center;
    }

    pre code,
    pre {
      background-color: #000a1a;
      color: #e6f0ff;
      padding: 8px;
      border-radius: 8px;
      display: block;
      overflow-x: auto;
      line-height: 1.5;
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, "Roboto Mono", "Fira Code", monospace;
      margin-top: 0
    }

    pre[class*="language-"] {
      background: #111213;
      color: #e6f0ff;
      border-radius: 8px;
      padding: 8px;
    }

    .content img {
      max-width: 100%;
      height: auto;
      border-radius: 6px;
      display: block;
      margin: 12px auto;
    }

    .meta {
      color: var(--muted-color);
      font-size: 0.9rem;
      margin-bottom: 6px;
      text-align: center;
    }

    blockquote {
      border-left: 4px solid rgba(255,255,255,0.06);
      margin: 0 0 1em 0;
      padding-left: 12px;
      color: var(--muted-color);
    }

    table {
      width: 100%;
      border-collapse: collapse;
      margin: 20px 0;
      background-color: rgba(255, 255, 255, 0.13);
      border: 1px solid rgba(218, 119, 86, 0.4);
      border-radius: 8px;
      overflow: hidden;
    }

    th, td {
      padding: 12px 16px;
      text-align: left;
      color: #ffffff;
      border-bottom: 1px solid rgba(218, 119, 86, 0.25);
    }

    th {
      background-color: rgba(218, 119, 86, 0.15);
      color: #da7756;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.03em;
    }

    tr:hover {
      background-color: rgba(218, 119, 86, 0.1);
      transition: background-color 0.2s ease-in-out;
    }

    caption {
      caption-side: bottom;
      padding: 8px;
      color: #da7756;
      font-style: italic;
      font-size: 0.9rem;
    }
  </style>
</head>
<body>
  <div class="page">
    <div class="reader">
      <article>
        <h1>${d}</h1>
        <div class="creation-date">${f}</div>

        ${o?`
          <div class="cover-wrapper">
            <img class="cover" src="${o}" alt="${d} — cover image">
            ${c?`<div class="caption">${c}</div>`:""}
          </div>
        `:""}

        <hr style="border: none; border-top: 1px solid gray; margin: 10px 0;">

        <section class="content">
          ${a}
        </section>
      </article>
    </div>
  </div>
</body>
</html>`}function Ie(t=""){return t.split(",").map(a=>a.trim()).filter(Boolean)}function de(t){var a,o,n="";if(typeof t=="string"||typeof t=="number")n+=t;else if(typeof t=="object")if(Array.isArray(t)){var r=t.length;for(a=0;a<r;a++)t[a]&&(o=de(t[a]))&&(n&&(n+=" "),n+=o)}else for(o in t)t[o]&&(n&&(n+=" "),n+=o);return n}function Re(){for(var t,a,o=0,n="",r=arguments.length;o<r;o++)(t=arguments[o])&&(a=de(t))&&(n&&(n+=" "),n+=a);return n}function P({children:t,variant:a="primary",onClick:o,disabled:n=!1,loading:r=!1,icon:l,iconPosition:i="left",className:d="",...c}){const f="inline-flex items-center justify-center gap-2 px-4 py-2 rounded-md text-sm font-medium transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-offset-2",g={primary:"bg-terra text-white hover:bg-terra-light focus:ring-terra-light disabled:opacity-50",outline:"border border-terra text-terra hover:bg-terra-light hover:text-black focus:ring-terra-light disabled:opacity-50",subtle:"bg-gray-700/70 text-gray-200 hover:bg-gray-700 focus:ring-gray-600 disabled:opacity-50",danger:"bg-danger text-white hover:bg-danger-hover focus:ring-red-600 disabled:opacity-70"};return e.jsxs("button",{onClick:o,disabled:n||r,className:Re(f,g[a],n&&"cursor-not-allowed",d),...c,children:[r&&e.jsx(me,{className:"animate-spin h-4 w-4 text-current"}),!r&&l&&i==="left"&&e.jsx(l,{className:"h-4 w-4"}),e.jsx("span",{children:t}),!r&&l&&i==="right"&&e.jsx(l,{className:"h-4 w-4"})]})}function I(){const t="hover:text-terra transition cursor-pointer underline-offset-4 hover:underline",a="text-terra font-semibold underline",{isSignedIn:o}=te(),n=z(),[r,l]=m.useState(!1),i=m.useRef(null),d=m.useRef(o);return m.useEffect(()=>{!d.current&&o&&(l(!1),n("/admin")),d.current=o},[o,n]),m.useEffect(()=>{function c(f){i.current&&!i.current.contains(f.target)&&l(!1)}return document.addEventListener("mousedown",c),()=>document.removeEventListener("mousedown",c)},[]),e.jsx("nav",{className:"w-full bg-neutral-800/70 backdrop-blur-sm border-b border-gray-800 py-3 px-6 text-gray-200",children:e.jsxs("div",{className:"max-w-7xl mx-auto flex items-center justify-between",children:[e.jsx("div",{className:"text-3xl font-bold font-mono text-terra",children:e.jsx(O,{to:"/",className:"hover:opacity-80 transition",children:"vectorThoughts"})}),e.jsxs("div",{className:"flex gap-6 items-center text-lg font-mono",children:[e.jsx(O,{to:o?"/admin":"/",className:({isActive:c})=>`${t} ${c?a:"text-gray-300"}`,children:"Blog"}),e.jsx(O,{to:"/about",className:({isActive:c})=>`${t} ${c?a:"text-gray-300"}`,children:"About"}),e.jsxs("div",{className:"relative",ref:i,children:[e.jsx("button",{"aria-haspopup":"menu","aria-expanded":r,onClick:()=>l(c=>!c),className:"p-2 rounded hover:bg-neutral-700/40 transition",title:"Open menu",children:e.jsxs("svg",{width:"20",height:"14",viewBox:"0 0 20 14",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:"text-gray-200",children:[e.jsx("rect",{y:"0.5",width:"20",height:"2",rx:"1",fill:"currentColor"}),e.jsx("rect",{y:"6",width:"20",height:"2",rx:"1",fill:"currentColor"}),e.jsx("rect",{y:"11.5",width:"20",height:"2",rx:"1",fill:"currentColor"})]})}),e.jsx("div",{className:`origin-top-right absolute right-0 mt-2 w-52 rounded-md shadow-lg ring-1 ring-black ring-opacity-20 bg-neutral-900 z-50 transform transition-all ${r?"opacity-100 scale-100":"opacity-0 scale-95 pointer-events-none"}`,role:"menu",hidden:!r&&!0,children:e.jsxs("div",{className:"py-1",children:[o?e.jsx("div",{className:"px-4 py-2",children:e.jsx(xe,{})}):e.jsx("div",{className:"px-4 py-2",children:e.jsx(ge,{children:e.jsx(P,{variant:"primary",children:"Sign In"})})}),e.jsx(O,{to:"/request-admin",onClick:()=>l(!1),className:({isActive:c})=>`block px-4 py-2 text-sm ${t} ${c?a:"text-gray-300"}`,role:"menuitem",children:"Invite Link"}),e.jsx(O,{to:"/tags",onClick:()=>l(!1),className:({isActive:c})=>`block px-4 py-2 text-sm ${t} ${c?a:"text-gray-300"}`,role:"menuitem",children:"Tags"})]})})]})]})]})})}function De(t){const{getToken:a}=se(),o=re(),n=J({queryKey:["post",t],queryFn:async({signal:i})=>_e({getToken:a,postId:t,signal:i}),enabled:!!t,staleTime:1e3*60*2,gcTime:1e3*60*10}),r=A({mutationFn:async i=>Pe({getToken:a,postId:t,payload:i}),onSuccess:i=>{o.setQueryData(["post",t],i)}}),l=A({mutationFn:async({formData:i,endpoint:d})=>Ae({getToken:a,formData:i,endpoint:d})});return{postQuery:n,saveMutation:r,uploadAssetMutation:l,queryClient:o}}const Te=m.lazy(()=>he(()=>import("./SimpleEditor-C9ZXTa3f.js"),__vite__mapDeps([0,1,2,3,4,5])));function Fe(){const t="http://localhost:8000",a=z(),{postId:o}=ae(),[n,r]=m.useState(""),[l,i]=m.useState(""),[d,c]=m.useState(null),[f,g]=m.useState(null),p=m.useRef(null),{postQuery:N,saveMutation:C,uploadAssetMutation:S}=De(o),{data:u,isLoading:$}=N,{register:w,handleSubmit:h,reset:L,control:D,watch:F}=fe({defaultValues:{title:"",slug:"",tagsText:"",summary:"",coverCaption:""}});m.useEffect(()=>{if(!u)return;const v=Array.isArray(u.tags)?u.tags.join(", "):"";if(L({title:u.title||"",slug:u.slug||"",tagsText:v,summary:u.summary||"",coverCaption:u.cover_caption||""}),u.raw&&r(u.raw),p.current&&(URL.revokeObjectURL(p.current),p.current=null),u.cover_asset_id){const j=new AbortController;return(async()=>{try{const k=await fetch(`${t}/api/assets/${u.cover_asset_id}`,{signal:j.signal});if(!k.ok){i(""),g(null);return}const E=await k.blob(),s=URL.createObjectURL(E);p.current=s,i(s),g({id:u.cover_asset_id,key:u.cover_image_key||null})}catch(k){k?.name,i(""),g(null)}})(),()=>{j.abort(),p.current&&(URL.revokeObjectURL(p.current),p.current=null)}}else i(""),g(null)},[u,L]);function G(v){const j=v?.target?.files?.[0];if(!j){l&&l.startsWith("blob:")&&URL.revokeObjectURL(l),c(null),i(""),g(null);return}l&&l.startsWith("blob:")&&URL.revokeObjectURL(l),c(j),i(URL.createObjectURL(j)),g(null)}function K(){l&&l.startsWith("blob:")&&URL.revokeObjectURL(l),c(null),i(""),g(null)}function H(v){return v?.id?`${t}/api/assets/${v.id}`:""}async function W(v,j){if(!d)return f||null;const k=new FormData;k.append("file",d,d.name),k.append("alt",`Cover image for ${v||"post"}`),k.append("caption",j&&j.trim()||v||""),o&&k.append("post_id",o);const E=await S.mutateAsync({formData:k,endpoint:`${t}/api/assets/upload-image`}),s=E.id||E.asset_id||E.assetId,x=E.link||E.public_link||E.url,b={id:s,link:x};return g(b),c(null),b}async function T(v){try{const j=v.title?.trim();let k=null;try{k=await W(j,v.coverCaption)}catch(x){console.error("Image upload failed:",x),alert("Cover image upload failed: "+(x.message||x))}const E=H(k||f),s={title:j,slug:v.slug?.trim()||Z(j),tags:Ie(v.tagsText),summary:v.summary?.trim(),raw:n,body:V(j,n,E,v.coverCaption,{hMargin:"5px",bgOpacity:.95}),status:"draft",...(k||f)?.id?{cover_asset_id:(k||f).id}:{}};await C.mutateAsync(s),console.log("Saved successfully")}catch(j){console.error("Save error:",j),alert("Error saving post: "+(j.message||j))}}async function M(v){try{await T(v);const j=new Date,k={day:"numeric",month:"long",year:"numeric"},E=j.toLocaleDateString("en-GB",k),s=H(f),x=V(v.title?.trim(),n,s,v.coverCaption,{hMargin:"5px",bgOpacity:.95},E),y=`${(v.slug?.trim()||Z(v.title||"")).replace(/\s+/g,"-").toLowerCase()}-post.html`,U=new Blob([x],{type:"text/html"}),B=new FormData;B.append("file",U,y),B.append("alt",`HTML snapshot for ${v.title||""}`),B.append("caption",v.title||v.coverCaption?.trim()||""),o&&B.append("post_id",o),await S.mutateAsync({formData:B,endpoint:`${t}/api/assets/html`}),a("/admin")}catch(j){console.error("Publish error:",j),alert("Error publishing post: "+(j.message||j))}}const Q=F("title");return e.jsxs("div",{className:"bg-black/90",children:[e.jsx(I,{}),e.jsxs("div",{className:"max-w-5xl mx-auto my-10 px-4 text-gray-100",children:[e.jsx("h1",{className:"text-3xl font-extrabold font-mono text-gray-300 pb-2 mb-6 border-b border-gray-200",children:"Create A New Post"}),e.jsxs("form",{onSubmit:h(T),children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"title",className:"block text-sm font-medium text-gray-300 mb-1",children:"Title"}),e.jsx("input",{...w("title",{required:!0}),type:"text",id:"title",name:"title",className:"mt-1 block w-full px-3 py-2 border border-gray-300 placeholder-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-terra focus:border-terra sm:text-sm",placeholder:"Enter the post title"})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row sm:space-x-4 mb-6",children:[e.jsxs("div",{className:"w-full sm:w-1/2 mb-4 sm:mb-0",children:[e.jsx("label",{htmlFor:"slug",className:"block text-sm font-medium text-gray-300 mb-1",children:"Slug"}),e.jsx("input",{...w("slug"),type:"text",id:"slug",name:"slug",placeholder:"Enter-the-slug-(Optional)",className:"border mt-1 block w-full px-3 py-2 border-gray-300 placeholder-gray-300 rounded-md focus:outline-none focus:ring-terra focus:border-terra sm:text-sm"})]}),e.jsxs("div",{className:"w-full sm:w-1/2",children:[e.jsx("label",{htmlFor:"tags",className:"block text-sm font-medium text-gray-300 mb-1",children:"Tags"}),e.jsx("input",{...w("tagsText"),type:"text",id:"tagsText",name:"tagsText",placeholder:"eg. tag1, tag2",className:"mt-1 block w-full px-3 py-2 border border-gray-300 placeholder-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-terra focus:border-terra sm:text-sm"})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"summary",className:"block text-sm font-medium text-gray-300 mb-1",children:"Summary"}),e.jsx("textarea",{...w("summary"),name:"summary",id:"summary",rows:3,placeholder:"Short Summary shown on Blog Cards",className:"mt-1 block w-full px-3 py-2 border border-gray-300 placeholder-gray-300 rounded-md focus:outline-none focus:ring-terra focus:border-terra sm:text-sm"})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{htmlFor:"coverImage",className:"block text-sm font-medium text-gray-300 mb-1",children:"Cover Image"}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("input",{type:"file",accept:"image/*",onChange:G}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(P,{onClick:K,variant:"danger",children:"Remove"}),e.jsx("span",{className:"text-sm text-gray-200",children:f?"Existing Cover Image Attached":d?d.name:"No Cover Image Attached"})]})]}),e.jsxs("div",{className:"mt-3",children:[e.jsx("label",{htmlFor:"coverCaption",className:"block text-sm font-medium text-gray-300 mb-1",children:"Cover Image Caption (optional — defaults to title if left empty)"}),e.jsx("input",{...w("coverCaption"),id:"coverCaption",type:"text",placeholder:"Caption for cover image",className:"mt-1 block w-full px-3 py-2 border border-gray-300 placeholder-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-terra focus:border-terra sm:text-sm"})]}),l&&e.jsxs("div",{className:"mt-4",children:[e.jsx("p",{className:"text-sm text-gray-300 mb-2",children:"Preview:"}),e.jsx("div",{className:"border rounded-lg overflow-hidden shadow-sm w-1/2",children:e.jsx("img",{src:l,alt:"Cover preview",className:"object-cover w-full h-40"})})]}),e.jsx("p",{className:"text-xs text-gray-400 mt-2",children:"Recommended: landscape images. Will show on blog card and post top."})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx(P,{type:"button",className:"ml-3",onClick:h(T),disabled:C.isLoading,variant:"primary",children:C.isLoading?"Creating...":"Create Post"}),o&&e.jsxs("span",{className:"ml-3 text-sm text-gray-400",children:["Post ID: ",o]})]})]}),e.jsx(m.Suspense,{fallback:e.jsx("div",{className:"text-sm text-gray-400",children:"Loading editor…"}),children:e.jsx(Te,{html:n,setHtml:r,postId:o})}),e.jsx("div",{className:"flex justify-start mt-4 gap-3",children:e.jsx(P,{onClick:h(T),disabled:C.isLoading,variant:"primary",children:C.isLoading?"Saving ...":"Save"})}),e.jsxs("div",{style:{marginTop:18},children:[e.jsx("strong",{children:"HTML output (preview)"}),e.jsx("div",{style:{border:"1px solid #ddd",padding:12,borderRadius:6,marginTop:8},children:e.jsx("div",{dangerouslySetInnerHTML:{__html:V((Q||"").trim(),n,l,"This a test cover image",{hMargin:"5px",bgOpacity:.5})}})})]}),e.jsx("button",{onClick:h(M),disabled:S?.isLoading||C.isLoading,className:"bg-green-800 hover:bg-green-700 text-white mt-4 font-bold py-2 px-4 rounded-lg cursor-pointer transition duration-300 ease-in-out",children:S?.isLoading?"Publishing...":"Publish"})]})]})}function ue({isPublished:t,onToggle:a}){return e.jsx("button",{onClick:a,className:`px-3 py-1 rounded-md text-sm font-medium border transition-all duration-200
        ${t?"bg-[#1a1a1a] border-terra text-terra hover:bg-[#2a2a2a]":"bg-neutral-900 border-neutral-700 text-neutral-400 hover:bg-neutral-800 hover:text-terra-light"}`,children:t?"Published":"Draft"})}function Ue({post:t,onOpen:a,onToggleStatus:o,onDelete:n,onEdit:r}){const l="http://localhost:8000",[i,d]=m.useState(!1),c=m.useRef(null),f=m.useRef(null),[g,p]=m.useState(!0),N="h-44";function C(){return t?.cover_asset_id?`${l}/api/assets/${t.cover_asset_id}`:null}const S=C();return m.useEffect(()=>{function u($){c.current&&!c.current.contains($.target)&&d(!1)}return i&&document.addEventListener("mousedown",u),()=>{document.removeEventListener("mousedown",u)}},[i]),m.useEffect(()=>{if(!i||!f.current)return;const u=f.current.getBoundingClientRect(),$=window.innerHeight,w=120,h=u.top,L=$-u.bottom;p(h>=w+8||h>L)},[i]),t.deleted?null:e.jsx("article",{className:`bg-neutral-800/70 shadow-xl p-0 overflow-hidden w-full max-w-6xl mx-auto rounded-md ${N}`,role:"article",children:e.jsxs("div",{className:"flex h-full",children:[e.jsxs("div",{className:"w-2/3 pr-4 flex flex-col justify-between p-4",children:[e.jsxs("div",{onClick:a,role:"link",tabIndex:0,children:[e.jsx("h3",{className:"text-lg font-semibold font-roboto mb-1 hover:cursor-pointer hover:underline hover:underline-offset-4 hover:text-terra-dark",children:t.title}),e.jsx("p",{className:"text-xs text-gray-500 mb-1",children:new Date(t.created_at).toLocaleDateString("en-IN",{day:"2-digit",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"})}),e.jsx("p",{className:"text-gray-300 text-sm line-clamp-2",children:t.summary})]}),e.jsxs("div",{className:"flex items-center justify-between mt-4",children:[e.jsx("div",{children:e.jsx(ue,{isPublished:t.status==="published",onToggle:()=>o(t.id)})}),e.jsxs("div",{className:"relative",ref:c,children:[e.jsxs("button",{ref:f,onClick:()=>d(u=>!u),className:"p-1 rounded-md hover:bg-neutral-800 transition text-gray-300","aria-haspopup":"true","aria-expanded":i,children:[e.jsx(ne,{className:"w-5 h-5"}),e.jsx("span",{className:"sr-only",children:"Open actions menu"})]}),i&&e.jsxs("div",{className:`absolute right-0 z-30 w-40 bg-neutral-900 border border-neutral-700 rounded-md shadow-lg origin-top-right transform ${g?"bottom-full mb-2":"top-full mt-2"}`,children:[g?e.jsx("div",{className:"absolute right-3 -bottom-1 w-3 h-3 bg-neutral-900 rotate-45 border border-neutral-700"}):e.jsx("div",{className:"absolute right-3 -top-1 w-3 h-3 bg-neutral-900 rotate-45 border border-neutral-700"}),e.jsxs("div",{className:"py-1",children:[e.jsxs("button",{onClick:()=>{d(!1),r(t.id)},className:"w-full text-left px-3 py-2 text-sm hover:bg-neutral-800 flex items-center gap-2",children:[e.jsx(oe,{className:"w-4 h-4 text-gray-300"}),e.jsx("span",{className:"text-gray-200",children:"Edit"})]}),e.jsxs("button",{onClick:()=>{d(!1),n(t.id)},className:"w-full text-left px-3 py-2 text-sm hover:bg-neutral-800 flex items-center gap-2",children:[e.jsx(le,{className:"w-4 h-4 text-red-400"}),e.jsx("span",{className:"text-red-300",children:"Delete"})]})]})]})]})]})]}),e.jsx("div",{onClick:a,role:"link",tabIndex:0,className:`w-1/3 flex-shrink-0 ${N} overflow-hidden`,children:e.jsx("img",{src:S||"/src/assets/img1.jpg",alt:t?.cover_image?.alt||"Cover Image",className:"w-full h-full object-cover hover:cursor-pointer"})})]})})}function Be({showDeleted:t,setShowDeleted:a,deletedCount:o}){return e.jsxs("label",{className:"flex items-center gap-2 bg-neutral-900 border border-neutral-700 rounded-md px-3 py-1 cursor-pointer text-sm select-none hover:bg-neutral-800 transition",onClick:()=>a(!t),children:[e.jsx("div",{className:`w-4 h-4 rounded-sm flex items-center justify-center border transition-colors
        ${t?"bg-[#da7756] border-[#da7756]":"bg-neutral-800 border-neutral-600"}`,children:t&&e.jsx(pe,{className:"w-3 h-3 text-black"})}),e.jsxs("span",{className:"text-gray-300",children:["Show Deleted ",e.jsxs("span",{className:"text-gray-500",children:["(",o,")"]})]})]})}function Oe({post:t,onOpen:a,onToggleStatus:o,onDelete:n,onEdit:r}){const l="http://localhost:8000",[i,d]=m.useState(!1),c=m.useRef(null),f=m.useRef(null),[g,p]=m.useState(!0),N="h-60";function C(){return t?.cover_asset_id?`${l}/api/assets/${t.cover_asset_id}`:null}const S=C();return m.useEffect(()=>{function u($){c.current&&!c.current.contains($.target)&&d(!1)}return i&&document.addEventListener("mousedown",u),()=>{document.removeEventListener("mousedown",u)}},[i]),m.useEffect(()=>{if(!i||!f.current)return;const u=f.current.getBoundingClientRect(),$=window.innerHeight,w=120,h=u.top,L=$-u.bottom;p(h>=w+8||h>L)},[i]),t.deleted?null:e.jsx("article",{className:`bg-neutral-800/70 shadow-xl p-0 overflow-hidden w-full max-w-6xl mx-auto rounded-md ${N}`,role:"article",children:e.jsxs("div",{className:"flex h-full",children:[e.jsx("div",{onClick:a,role:"link",tabIndex:0,className:`w-1/3 flex-shrink-0 ${N} overflow-hidden`,children:e.jsx("img",{src:S||"/src/assets/img1.jpg",alt:t?.cover_image?.alt||"Cover Image",className:"w-full h-full object-cover hover:cursor-pointer"})}),e.jsxs("div",{className:"w-2/3 pl-10 flex flex-col justify-between p-4",children:[e.jsxs("div",{onClick:a,role:"link",tabIndex:0,children:[e.jsx("h3",{className:"text-[23px] justify-end font-roboto font-semibold mb-1 hover:cursor-pointer hover:underline hover:underline-offset-4 hover:text-terra-dark",children:t.title}),e.jsx("p",{className:"text-[16px] text-gray-500 mb-1",children:new Date(t.created_at).toLocaleDateString("en-IN",{day:"2-digit",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"})}),e.jsx("p",{className:"text-gray-300 text-[19px] line-clamp-2",children:t.summary})]}),e.jsxs("div",{className:"flex items-center justify-between mt-4",children:[e.jsx("div",{children:e.jsx(ue,{isPublished:t.status==="published",onToggle:()=>o(t.id)})}),e.jsxs("div",{className:"relative",ref:c,children:[e.jsxs("button",{ref:f,onClick:()=>d(u=>!u),className:"p-1 rounded-md hover:bg-neutral-800 transition text-gray-300","aria-haspopup":"true","aria-expanded":i,children:[e.jsx(ne,{className:"w-5 h-5"}),e.jsx("span",{className:"sr-only",children:"Open actions menu"})]}),i&&e.jsxs("div",{className:`absolute right-0 z-30 w-40 bg-neutral-900 border border-neutral-700 rounded-md shadow-lg origin-top-right transform ${g?"bottom-full mb-2":"top-full mt-2"}`,children:[g?e.jsx("div",{className:"absolute right-3 -bottom-1 w-3 h-3 bg-neutral-900 rotate-45 border border-neutral-700"}):e.jsx("div",{className:"absolute right-3 -top-1 w-3 h-3 bg-neutral-900 rotate-45 border border-neutral-700"}),e.jsxs("div",{className:"py-1",children:[e.jsxs("button",{onClick:()=>{d(!1),r(t.id)},className:"w-full text-left px-3 py-2 text-sm hover:bg-neutral-800 flex items-center gap-2",children:[e.jsx(oe,{className:"w-4 h-4 text-gray-300"}),e.jsx("span",{className:"text-gray-200",children:"Edit"})]}),e.jsxs("button",{onClick:()=>{d(!1),n(t.id)},className:"w-full text-left px-3 py-2 text-sm hover:bg-neutral-800 flex items-center gap-2",children:[e.jsx(le,{className:"w-4 h-4 text-red-400"}),e.jsx("span",{className:"text-red-300",children:"Delete"})]})]})]})]})]})]})]})})}async function R(t,a,o={}){const r={"Content-Type":"application/json",Authorization:`Bearer ${await t()}`,...o.headers||{}},l=await fetch(a,{...o,headers:r});if(!l.ok){const d=(await l.json().catch(()=>null))?.detail||await l.text().catch(()=>null)||l.statusText,c=new Error(`HTTP ${l.status}: ${d}`);throw c.status=l.status,c.response=l,c}return l.status===204?null:l.json().catch(()=>null)}async function He({getToken:t,backendUrl:a,limit:o=50,skip:n=0,showDeleted:r=!1}){const l=`${a}/api/posts?limit=${o}&skip=${n}${r?"&show_deleted=1":""}`;return R(t,l)}async function Me({getToken:t,backendUrl:a,id:o}){const n=`${a}/api/posts/${encodeURIComponent(o)}`;return R(t,n)}async function Qe({getToken:t,backendUrl:a}){const o=`${a}/api/posts`;return R(t,o,{method:"POST"})}async function qe({getToken:t,backendUrl:a,id:o,status:n}){const r=`${a}/api/posts/${o}/status?status=${encodeURIComponent(n)}`;return R(t,r,{method:"PATCH"})}async function ze({getToken:t,backendUrl:a,id:o}){const n=`${a}/api/posts/${o}/delete`;return R(t,n,{method:"PATCH"})}async function Ge({getToken:t,backendUrl:a,id:o}){const n=`${a}/api/posts/${o}/restore`;return R(t,n,{method:"PATCH"})}async function Ke({getToken:t,backendUrl:a,id:o}){const n=`${a}/api/posts/${o}/delete`;return R(t,n,{method:"DELETE"})}function We(){const{getToken:t}=se(),a="http://localhost:8000",o=z(),n=re(),[r,l]=m.useState(!1),[i,d]=m.useState(new Set),[c,f]=m.useState(new Set),g=(s,x)=>d(b=>{const y=new Set(b);return x?y.add(s):y.delete(s),y}),p=(s,x)=>f(b=>{const y=new Set(b);return x?y.add(s):y.delete(s),y}),{data:N=[],isLoading:C,isError:S,error:u}=J({queryKey:["posts",{showDeleted:r}],queryFn:async()=>He({getToken:t,backendUrl:a,limit:20,skip:0,showDeleted:r}),staleTime:1e3*30,gcTime:1e3*60*10});S&&(console.error("Error fetching posts",u),alert("Error fetching posts: "+(u.message||u)));const $=m.useMemo(()=>N.filter(s=>r?!0:!s.is_deleted),[N,r]),w=m.useMemo(()=>N.filter(s=>s.is_deleted).length,[N]),h=$.length>0?$[0]:null,L=$.length>1?$.slice(1):[],{mutate:D,isLoading:F}=A({mutationFn:()=>Qe({getToken:t,backendUrl:a}),onSuccess:s=>{const x=s?.id||s?.post_id;n.invalidateQueries(["posts"]),x&&o(`/admin/publish/${x}`)},onError:s=>{console.error("Create post failed:",s),alert("Error creating new post: "+(s.message||s))}}),{mutate:G}=A({mutationFn:({id:s,newStatus:x})=>qe({getToken:t,backendUrl:a,id:s,status:x}),onMutate:async({id:s,newStatus:x})=>{await n.cancelQueries(["posts",{showDeleted:r}]);const b=n.getQueryData(["posts",{showDeleted:r}]);return n.setQueryData(["posts",{showDeleted:r}],(y=[])=>y.map(U=>U.id===s?{...U,status:x}:U)),g(s,!0),{previous:b,id:s}},onError:(s,x,b)=>{console.error("Toggle status failed:",s),alert("Failed to toggle status: "+(s.message||s)),n.setQueryData(["posts",{showDeleted:r}],b.previous)},onSettled:(s,x,b,y)=>{g(y?.id,!1),n.invalidateQueries(["posts",{showDeleted:r}])}}),{mutate:K}=A({mutationFn:({id:s})=>ze({getToken:t,backendUrl:a,id:s}),onMutate:async({id:s})=>{await n.cancelQueries(["posts",{showDeleted:r}]);const x=n.getQueryData(["posts",{showDeleted:r}]);return n.setQueryData(["posts",{showDeleted:r}],(b=[])=>b.map(y=>y.id===s?{...y,is_deleted:!0}:y)),g(s,!0),{previous:x,id:s}},onError:(s,x,b)=>{console.error("Soft delete failed:",s),alert("Failed to soft delete: "+(s.message||s)),n.setQueryData(["posts",{showDeleted:r}],b.previous)},onSettled:(s,x,b,y)=>{g(y?.id,!1),n.invalidateQueries(["posts",{showDeleted:r}])}}),{mutate:H}=A({mutationFn:({id:s})=>Ge({getToken:t,backendUrl:a,id:s}),onMutate:async({id:s})=>{await n.cancelQueries(["posts",{showDeleted:r}]);const x=n.getQueryData(["posts",{showDeleted:r}]);return n.setQueryData(["posts",{showDeleted:r}],(b=[])=>b.map(y=>y.id===s?{...y,is_deleted:!1}:y)),g(s,!0),{previous:x,id:s}},onError:(s,x,b)=>{console.error("Restore failed:",s),alert("Failed to restore: "+(s.message||s)),n.setQueryData(["posts",{showDeleted:r}],b.previous)},onSettled:(s,x,b,y)=>{g(y?.id,!1),n.invalidateQueries(["posts",{showDeleted:r}])}}),{mutate:W}=A({mutationFn:({id:s})=>Ke({getToken:t,backendUrl:a,id:s}),onMutate:({id:s})=>{p(s,!0)},onSuccess:(s,{id:x})=>{n.setQueryData(["posts",{showDeleted:r}],(b=[])=>b.filter(y=>y.id!==x))},onError:(s,x)=>{console.error("Permanent delete failed:",s),alert("Failed to permanently delete post: "+(s.message||s))},onSettled:(s,x,b)=>{p(b?.id,!1),n.invalidateQueries(["posts",{showDeleted:r}])}}),T=s=>{n.prefetchQuery({queryKey:["post",s],queryFn:()=>Me({getToken:t,backendUrl:a,id:s}),staleTime:1e3*60*5})};function M(s){const x=N.find(y=>y.id===s);if(!x)return;const b=x.status==="published"?"draft":"published";G({id:s,newStatus:b})}function Q(s){K({id:s})}function v(s){H({id:s})}function j(s){window.confirm("This will permanently delete the post. Click ok to continue")&&W({id:s})}function k(s){const x=s.slug,b=s.html_asset_id;o(`/article/${x}`,{state:{postId:s.id,assetId:b}})}function E(s){T(s),o(`/admin/publish/${s}`)}return e.jsxs("div",{className:"min-h-screen bg-black/95 text-gray-300",children:[e.jsx(I,{}),e.jsxs("div",{className:"max-w-6xl mx-auto p-6 flex flex-col gap-6",children:[e.jsxs("header",{className:"flex items-center justify-between",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Admin-Dashboard"}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(P,{onClick:D,loading:F,variant:"outline",icon:be,children:"New Post"}),e.jsx(Be,{showDeleted:r,setShowDeleted:l,deletedCount:w})]})]}),C?e.jsxs(e.Fragment,{children:[e.jsx(q,{size:"60",bgOpacity:"0.1",speed:"1.4",color:"#da7756"}),e.jsx("p",{className:"text-gray-300 text-sm tracking-wide",children:"Loading Posts"})]}):$.length===0?e.jsx("div",{className:"text-center text-gray-500 py-12",children:"No posts yet. Create one."}):e.jsxs(e.Fragment,{children:[h&&e.jsx("section",{className:"flex flex-col gap-4",children:h.is_deleted?e.jsxs("div",{className:"bg-neutral-800/60 border border-neutral-700/60 rounded-md p-4 flex items-center justify-between shadow-md hover:shadow-lg hover:bg-neutral-800/80 transition-all duration-200",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h3",{className:"font-semibold text-gray-200 text-base",children:h.title}),e.jsx("span",{className:"text-xs px-2 py-0.5 rounded-full bg-red-500/20 text-red-400 border border-red-400/30 uppercase tracking-wide",children:"Deleted"})]}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:new Date(h.date).toLocaleDateString("en-IN",{day:"2-digit",month:"short",year:"numeric"})})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>v(h.id),disabled:i.has(h.id),className:`px-3 py-1.5 rounded-md text-sm font-medium transition-all ${i.has(h.id)?"bg-neutral-700 text-gray-400 cursor-not-allowed":"bg-green-600/20 text-green-400 hover:bg-green-600/30 hover:text-green-300"}`,children:i.has(h.id)?"Restoring…":"Restore"}),e.jsx("button",{onClick:()=>j(h.id),disabled:c.has(h.id),className:`px-3 py-1.5 rounded-md text-sm font-medium transition-all ${c.has(h.id)?"bg-neutral-700 text-gray-400 cursor-not-allowed":"bg-red-600/20 text-red-400 hover:bg-red-600/30 hover:text-red-300"}`,children:c.has(h.id)?"Deleting…":"Delete Permanently"})]})]}):e.jsx(Oe,{post:h,onOpen:()=>k(h),onToggleStatus:()=>M(h.id),onDelete:()=>Q(h.id),onEdit:()=>E(h.id)})}),e.jsx("section",{className:"flex flex-col gap-4 mt-6",children:L.map(s=>s.is_deleted?e.jsxs("div",{className:"bg-neutral-800/60 border border-neutral-700/60 rounded-md p-4 flex items-center justify-between shadow-md hover:shadow-lg hover:bg-neutral-800/80 transition-all duration-200",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h3",{className:"font-semibold text-gray-200 text-base",children:s.title}),e.jsx("span",{className:"text-xs px-2 py-0.5 rounded-full bg-red-500/20 text-red-400 border border-red-400/30 uppercase tracking-wide",children:"Deleted"})]}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:new Date(s.date).toLocaleDateString("en-IN",{day:"2-digit",month:"short",year:"numeric"})})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>v(s.id),disabled:i.has(s.id),className:`px-3 py-1.5 rounded-md text-sm font-medium transition-all ${i.has(s.id)?"bg-neutral-700 text-gray-400 cursor-not-allowed":"bg-green-600/20 text-green-400 hover:bg-green-600/30 hover:text-green-300"}`,children:i.has(s.id)?"Restoring…":"Restore"}),e.jsx("button",{onClick:()=>j(s.id),disabled:c.has(s.id),className:`px-3 py-1.5 rounded-md text-sm font-medium transition-all ${c.has(s.id)?"bg-neutral-700 text-gray-400 cursor-not-allowed":"bg-red-600/20 text-red-400 hover:bg-red-600/30 hover:text-red-300"}`,children:c.has(s.id)?"Deleting…":"Delete Permanently"})]})]},s.id):e.jsx(Ue,{post:s,onOpen:()=>k(s),onToggleStatus:()=>M(s.id),onDelete:()=>Q(s.id),onEdit:()=>E(s.id)},s.id))})]})]})]})}const X="http://localhost:8000";function Ve(){const{slug:t}=ae(),a=ye(),{postId:o,assetId:n}=a.state||{},r=async({signal:f})=>{if(!o||!n)throw new c("Missing Post Ids");const g=`${X}/api/assets/${n}`,p=await fetch(g,{method:"GET",headers:{Accept:"text/html"},signal:f});if(!p.ok){const S=await p.text().catch(()=>"");throw new Error(`HTML fetch failed: ${p.status} ${S}`)}const N=await p.text();return`<base href="${`${X}/api/assets/${n}`}">${N}`},{data:l,isLoading:i,isError:d,error:c}=J({queryKey:["publicPosts",t],queryFn:r,enabled:!!t,staleTime:0,gcTime:1e3*60,refetchOnMount:"always",refetchOnWindowFocus:!1});if(i)return e.jsxs("div",{className:"flex flex-col items-center gap-3 mt-50",children:[e.jsx(q,{size:"60",bgOpacity:"0.1",speed:"1.4",color:"#da7756"}),e.jsx("p",{className:"text-black text-sm tracking-wide",children:"Loading Post..."})]});if(d){const f=c instanceof Error?c.message:String(c);return e.jsxs("div",{className:"blog-error",children:["Error: ",f]})}return e.jsx("div",{className:"blog-content",dangerouslySetInnerHTML:{__html:l||"<p>No content</p>"}})}function Je(){return e.jsxs("div",{className:"min-h-screen bg-neutral-900 text-gray-900",children:[e.jsx(I,{}),e.jsx("div",{className:"max-w-2xl mx-auto p-6",children:e.jsx("h3",{className:"text-3xl text-center font-extrabold font-mono text-gray-300 pb-2 mb-6 border-b border-gray-200",children:" About Page Upcoming"})})]})}function Ye(){return e.jsxs("div",{className:"min-h-screen bg-neutral-900 text-gray-900",children:[e.jsx(I,{}),e.jsx("div",{className:"max-w-2xl mx-auto p-6",children:e.jsx("h3",{className:"text-3xl text-center font-extrabold font-mono text-gray-300 pb-2 mb-6 border-b border-gray-200",children:" Tags Page Upcoming"})})]})}function Ze(){const[t,a]=m.useState({name:"",email:"",portfolio:""}),[o,n]=m.useState(!1),[r,l]=m.useState(""),[i,d]=m.useState("");function c(g){a(p=>({...p,[g.target.name]:g.target.value}))}async function f(g){if(g.preventDefault(),d(null),l(null),!t.name.trim()||!t.email.trim()){d("Name and Email are required");return}n(!0);try{const p=await fetch("/api/request-admin",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}),N=await p.json();if(!p.ok){const C=await p.text();throw new i(`Failed to submit request: ${text}`)}a({name:"",email:"",portfolio:""})}catch(p){d(p.message)}finally{n(!1)}}return e.jsx("div",{className:"bg-neutral-900/95 w-full min-h-screen",children:e.jsxs("div",{className:"max-w-2xl mx-auto p-6",children:[e.jsx("h1",{className:"text-3xl font-extrabold font-mono text-gray-300 pb-2 mb-6 border-b border-gray-200",children:"If you want to contribute to the Blog"}),e.jsxs("form",{onSubmit:f,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Full name"}),e.jsx("input",{name:"name",value:t.name,onChange:c,className:"border mt-1 block w-full px-3 py-2 border-gray-300 placeholder-gray-300 rounded-md focus:outline-none focus:ring-terra focus:border-terra sm:text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Email"}),e.jsx("input",{name:"email",value:t.email,onChange:c,type:"email",className:"border mt-1 block w-full px-3 py-2 border-gray-300 placeholder-gray-300 rounded-md focus:outline-none focus:ring-terra focus:border-terra sm:text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Portfolio / relevant links (optional)"}),e.jsx("input",{name:"portfolio",value:t.portfolio,onChange:c,className:"border mt-1 block w-full px-3 py-2 border-gray-300 placeholder-gray-300 rounded-md focus:outline-none focus:ring-terra focus:border-terra sm:text-sm"})]}),e.jsxs("div",{children:[e.jsx(P,{type:"submit",disabled:o,variant:"primary",children:o?"Submitting...":"Submit Request"}),r&&e.jsx("span",{className:"text-green-400 px-2",children:r}),i&&e.jsx("span",{className:"text-red-400 px-2",children:i})]})]})]})})}function Xe({post:t,onOpen:a}){const o="h-42",n="http://localhost:8000";function r(){return t?.cover_asset_id?`${n}/api/assets/${t.cover_asset_id}`:null}return e.jsx("article",{className:`bg-neutral-800/70 shadow-xl p-0 overflow-hidden w-full max-w-6xl mx-auto rounded-md ${o}`,role:"article",children:e.jsxs("div",{className:"flex h-full",children:[e.jsx("div",{className:"w-2/3 pr-4 flex flex-col justify-between p-4",children:e.jsxs("div",{onClick:a,role:"link",tabIndex:0,children:[e.jsx("h3",{className:"text-lg font-semibold font-roboto mb-1 hover:cursor-pointer hover:underline hover:underline-offset-4 hover:text-terra-dark",children:t.title}),e.jsx("p",{className:"text-xs text-gray-500 mb-2",children:new Date(t.created_at).toLocaleDateString("en-IN",{day:"2-digit",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"})}),e.jsx("p",{className:"text-gray-300 text-sm line-clamp-3",children:t.summary})]})}),e.jsx("div",{onClick:a,role:"link",tabIndex:0,className:`w-1/3 flex-shrink-0 ${o} overflow-hidden`,children:e.jsx("img",{src:r(),alt:t?.cover_image?.alt||"Cover Image",className:"w-full h-full object-cover hover:cursor-pointer"})})]})})}function et({post:t,onOpen:a}){const o="h-60",n="http://localhost:8000";function r(){return t?.cover_asset_id?`${n}/api/assets/${t.cover_asset_id}`:null}return e.jsx("article",{className:`bg-neutral-800/70 shadow-xl p-0 overflow-hidden w-full max-w-6xl mx-auto rounded-md ${o}`,role:"article",children:e.jsxs("div",{className:"flex h-full",children:[e.jsx("div",{onClick:a,role:"link",tabIndex:0,className:`w-1/3 flex-shrink-0 ${o} overflow-hidden`,children:e.jsx("img",{src:r(),alt:t?.cover_image?.alt||"Cover Image",className:"w-full h-full object-cover hover:cursor-pointer"})}),e.jsx("div",{className:"w-2/3 pl-10 flex flex-col justify-between p-4",children:e.jsxs("div",{onClick:a,role:"link",tabIndex:0,children:[e.jsxs("h3",{className:"text-[23px] justify-end font-roboto font-semibold mb-1 hover:cursor-pointer hover:underline hover:underline-offset-4 hover:text-terra-dark",children:[e.jsx("span",{className:"text-terra text-xs p-1 rounded-md mr-3 bg-orange-200/10",children:"Recent"}),t.title]}),e.jsx("p",{className:"text-[16px] text-gray-500 mb-1",children:new Date(t.created_at).toLocaleDateString("en-IN",{day:"2-digit",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"})}),e.jsx("p",{className:"text-gray-300 text-[19px] line-clamp-2",children:t.summary})]})})]})})}const tt="http://localhost:8000";function st(){const t=z(),a=10,o=async({pageParam:w=0,signal:h})=>{const L=`${tt}/api/public/posts?limit=${a}&skip=${w}`,D=await fetch(L,{method:"GET",signal:h});if(!D.ok){const F=await D.text();throw new Error(`Posts Loading error: ${F}`)}return D.json()},{data:n,isLoading:r,isError:l,error:i,fetchNextPage:d,hasNextPage:c,isFetchingNextPage:f,refetch:g}=ve({queryKey:["publicPosts"],queryFn:o,getNextPageParam:(w,h)=>{if(Array.isArray(w)&&w.length===a)return h.length*a},staleTime:1e3*60*1}),{ref:p,inView:N}=je();if(m.useEffect(()=>{N&&c&&!f&&d()},[d,N,c,f]),r)return e.jsxs("div",{className:"min-h-screen bg-black/95 text-gray-300",children:[e.jsx(I,{}),e.jsx("div",{className:"max-w-6xl mx-auto p-6 flex flex-col gap-7 mt-5",children:e.jsx("section",{className:"flex flex-col gap-4",children:e.jsxs("div",{className:"flex flex-col items-center justify-center py-16 gap-4 mt-60",children:[e.jsx(q,{size:"60",bgOpacity:"0.1",speed:"1.4",color:"#da7756"}),e.jsx("p",{className:"text-gray-300 text-sm tracking-wide",children:"Loading Posts"})]})})})]});if(l)return console.error("Error fetching posts:",i),i instanceof Error?i.message:str(i),e.jsxs("div",{className:"min-h-screen bg-black/95 text-gray-300",children:[e.jsx(I,{}),e.jsxs("div",{className:"max-w-6xl mx-auto p-6 flex flex-col gap-7 mt-5",children:[e.jsxs("div",{className:"blog-error",children:["Error fetching posts: ",msg]}),e.jsx("div",{children:e.jsx(P,{onClick:()=>g(),variant:"primary",children:"Retry"})})]})]});function C(w){const h=w.slug,L=w.html_asset_id;t(`/article/${h}`,{state:{postId:w.id,assetId:L}})}const S=n?.pages?.flat()||[],u=S.length>0?S[0]:null,$=S.slice(1);return e.jsxs("div",{className:"min-h-screen bg-black/95 text-gray-300",children:[e.jsx(I,{}),e.jsx("div",{className:"max-w-6xl mx-auto p-6 flex flex-col gap-7 mt-5",children:e.jsxs("section",{className:"flex flex-col gap-4",children:[S.length===0&&e.jsxs("div",{className:"flex flex-col items-center justify-center py-16 gap-4",children:[e.jsx(we,{size:"70",speed:"1.75",color:"#da7756"}),e.jsx("p",{className:"text-gray-300 text-sm tracking-wide",children:"No posts yet"})]}),u&&e.jsx("section",{className:"flex flex-col gap-4",children:e.jsx(et,{post:u,onOpen:()=>C(u)})}),e.jsx("section",{className:"flex flex-col gap-4 mt-6",children:$.map(w=>e.jsx(Xe,{post:w,onOpen:()=>C(w)},w.id))}),e.jsx("div",{className:"flex flex-col items-center gap-3 mt-6",children:f?e.jsxs("div",{children:[e.jsx(q,{size:"40",bgOpacity:"0.1",speed:"1.2",color:"#da7756"}),e.jsx("p",{className:"text-sm text-gray-300",children:"Loading more…"})]}):c?e.jsxs(e.Fragment,{children:[e.jsx("div",{ref:p}),e.jsx(P,{onClick:()=>d(),variant:"primary",children:"Load More"})]}):e.jsx("p",{className:"text-sm text-gray-400",children:"No more posts"})})]})})]})}function ee({children:t}){const{isSignedIn:a,user:o}=te(),[n,r]=m.useState(!0),[l,i]=m.useState(!1);return m.useEffect(()=>{if(typeof a=="boolean"){if(!a){i(!1),r(!1);return}o&&o.id==="user_34CM89upzwvwrDbBxOVJGdxT8FW"?i(!0):i(!1),r(!1)}},[a,o]),n?e.jsx("div",{children:"Loading..."}):l?e.jsx(e.Fragment,{children:t}):e.jsx(ie,{to:"/",replace:!0})}function rt(){return e.jsx(Ne,{basename:"/vectorthoughts",children:e.jsxs(ke,{children:[e.jsx(_,{path:"/",element:e.jsx(st,{})}),e.jsx(_,{path:"/about",element:e.jsx(Je,{})}),e.jsx(_,{path:"/tags",element:e.jsx(Ye,{})}),e.jsx(_,{path:"/article/:slug",element:e.jsx(Ve,{})}),e.jsx(_,{path:"/request-admin",element:e.jsx(Ze,{})}),e.jsx(_,{path:"/admin/publish/:postId",element:e.jsx(ee,{children:e.jsx(Fe,{})})}),e.jsx(_,{path:"/admin",element:e.jsx(ee,{children:e.jsx(We,{})})}),e.jsx(_,{path:"*",element:e.jsx(ie,{to:"/",replace:!0})})]})})}const at=new Ce,nt="pk_test_bWFueS1ib25lZmlzaC0zNy5jbGVyay5hY2NvdW50cy5kZXYk";Se.createRoot(document.getElementById("root")).render(e.jsx(m.StrictMode,{children:e.jsx($e,{publishableKey:nt,children:e.jsxs(Ee,{client:at,children:[e.jsx(rt,{}),e.jsx(Le,{initialIsOpen:!1})]})})}));
