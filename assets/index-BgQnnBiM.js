const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/SimpleEditor-Dcq-cYeD.js","assets/react-MSu_GSUq.js","assets/froala-BSJra1Lq.js","assets/froala-CEphu8CV.css","assets/react-niSHVoSi.css","assets/SimpleEditor-B3WgNbCz.css"])))=>i.map(i=>d[i]);
import{j as e,L as he,u as re,a as Q,r as m,N as _,U as Z,S as X,b as ae,c as ne,d as J,e as A,_ as ge,f as oe,g as fe,E as le,P as ie,T as ce,C as pe,h as be,l as q,i as ye,k as ve,m as je,n as we,o as de,B as Ne,R as ke,p as I,Q as Ce,q as Se,s as $e,t as Le,v as Ee}from"./react-MSu_GSUq.js";import"./froala-BSJra1Lq.js";(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))o(r);new MutationObserver(r=>{for(const l of r)if(l.type==="childList")for(const i of l.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&o(i)}).observe(document,{childList:!0,subtree:!0});function n(r){const l={};return r.integrity&&(l.integrity=r.integrity),r.referrerPolicy&&(l.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?l.credentials="include":r.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function o(r){if(r.ep)return;r.ep=!0;const l=n(r);fetch(r.href,l)}})();const ue="https://vectorthoughts.xyz";async function Y(t,a,n={}){const o=await t(),l={...n.headers||{},Authorization:`Bearer ${o}`};return!Object.keys(l).some(d=>d.toLowerCase()==="content-type")&&!(n.body instanceof FormData)&&(l["Content-Type"]="application/json"),await fetch(a,{...n,headers:l})}async function _e({getToken:t,postId:a,signal:n}){if(!a)throw new Error("postId is required");const o=`${ue}/api/posts/${a}`,r=await Y(t,o,{signal:n});if(!r.ok){const l=await r.text().catch(()=>"");throw new Error(`Fetch post failed: ${r.status} ${l||""}`)}return r.json()}async function Pe({getToken:t,postId:a,payload:n}){if(!a)throw new Error("postId is required");const o=`${ue}/api/posts/${a}`,r=await Y(t,o,{method:"PATCH",body:JSON.stringify(n)});if(!r.ok){const l=await r.text().catch(()=>"");throw new Error(`Save failed: ${r.status} ${l||""}`)}return r.json()}async function Ie({getToken:t,formData:a,endpoint:n}){if(!a)throw new Error("formData is required");const r=await Y(t,n,{method:"POST",body:a});if(!r.ok){const l=await r.text().catch(()=>"");throw new Error(`Upload failed: ${r.status} ${l||""}`)}return r.json()}function ee(t=""){return t.toString().trim().toLowerCase().replace(/\s+/g,"-").replace(/[^\w-]+/g,"").replace(/--+/g,"-").replace(/^-+/g,"").replace(/-+$/,"")}function V(t,a,n="",o="",r={},l=""){const i=(N="")=>String(N).replaceAll("&","&amp;").replaceAll("<","&lt;").replaceAll(">","&gt;").replaceAll('"',"&quot;"),u=i(t||"Preview"),d=i(o||""),p=i(l||"Date will be added here"),g=r.hMargin||"12px";typeof r.bgOpacity=="number"?r.bgOpacity:parseFloat(r.bgOpacity||"0.95");const c=r.titleWeight||"700";return`<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>${u}</title>

  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=BBH+Sans+Hegarty:wght@400;700&family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">

  <style>
    :root{
      --page-bg: rgba(0, 0, 0, 0.95);
      --link-color: #da7756;
      --muted-color: #9fb0c8;
      --text-color: #ffffff;
      --page-padding: 28px;
      --h-margin: ${g};
      --content-max-width: 1000px;
    }
    
    html {
      background-color: #1a1a1a;
    }

    html, body {
      height: 100%;
      margin: 0;
      padding: 0;
      background: var(--page-bg);
      color: var(--text-color);
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
      font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
    }

    .page {
      box-sizing: border-box;
      min-height: 100%;
      padding: var(--page-padding);
      display: flex;
      justify-content: center;
    }

    .reader {
      width: 100%;
      max-width: var(--content-max-width);
      margin: 0 auto;
    }

    h1 {
      margin: 0 0 6px 0;
      font-family: "BBH Sans Hegarty", system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
      font-weight: ${c};
      letter-spacing: -0.01em;
      font-size: clamp(22px, 3.2vw, 36px);
      color: var(--text-color);
      text-align: center;
    }

    .creation-date {
      text-align: center;
      font-family: "Roboto", system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
      font-size: 0.9rem;
      color: var(--muted-color);
      margin-bottom: 18px;
      letter-spacing: 0.02em;
    }

    h2, h3, h4, h5, h6 {
      font-family: "Roboto", system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
      font-weight: 500;
      margin-top: 1.2em;
      margin-bottom: 0.5em;
      text-align: center;
      color: var(--text-color);
    }

    .content {
      margin-top: 18px;
      line-height: 1.6;
      color: var(--text-color);
      text-align: justify;
    }

    .content a, a {
      color: var(--link-color);
      text-decoration: underline;
    }

    .cover-wrapper {
      margin: 12px auto;
      padding-left: var(--h-margin);
      padding-right: var(--h-margin);
      text-align: center;
    }

    .cover {
      display: block;
      width: calc(100% - (var(--h-margin) * 2));
      max-height: 60vh;
      height: auto;
      margin: 0 auto;
      border-radius: 8px;
      object-fit: cover;
      box-shadow: 0 6px 18px rgba(0,0,0,0.6);
    }

    .caption {
      margin-top: 6px;
      color: var(--muted-color);
      font-size: 0.9rem;
      font-style: italic;
      text-align: center;
    }

    pre code,
    pre {
      background-color: #000a1a;
      color: #e6f0ff;
      padding: 8px;
      border-radius: 8px;
      display: block;
      overflow-x: auto;
      line-height: 1.5;
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, "Roboto Mono", "Fira Code", monospace;
      margin-top: 0
    }

    pre[class*="language-"] {
      background: #111213;
      color: #e6f0ff;
      border-radius: 8px;
      padding: 8px;
    }

    .content img {
      max-width: 100%;
      height: auto;
      border-radius: 6px;
      display: block;
      margin: 12px auto;
    }

    .meta {
      color: var(--muted-color);
      font-size: 0.9rem;
      margin-bottom: 6px;
      text-align: center;
    }

    blockquote {
      border-left: 4px solid rgba(255,255,255,0.06);
      margin: 0 0 1em 0;
      padding-left: 12px;
      color: var(--muted-color);
    }

    table {
      width: 100%;
      border-collapse: collapse;
      margin: 20px 0;
      background-color: rgba(255, 255, 255, 0.13);
      border: 1px solid rgba(218, 119, 86, 0.4);
      border-radius: 8px;
      overflow: hidden;
    }

    th, td {
      padding: 12px 16px;
      text-align: left;
      color: #ffffff;
      border-bottom: 1px solid rgba(218, 119, 86, 0.25);
    }

    th {
      background-color: rgba(218, 119, 86, 0.15);
      color: #da7756;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.03em;
    }

    tr:hover {
      background-color: rgba(218, 119, 86, 0.1);
      transition: background-color 0.2s ease-in-out;
    }

    caption {
      caption-side: bottom;
      padding: 8px;
      color: #da7756;
      font-style: italic;
      font-size: 0.9rem;
    }
  </style>
</head>
<body>
  <div class="page">
    <div class="reader">
      <article>
        <h1>${u}</h1>
        <div class="creation-date">${p}</div>

        ${n?`
          <div class="cover-wrapper">
            <img class="cover" src="${n}" alt="${u} — cover image">
            ${d?`<div class="caption">${d}</div>`:""}
          </div>
        `:""}

        <hr style="border: none; border-top: 1px solid gray; margin: 10px 0;">

        <section class="content">
          ${a}
        </section>
      </article>
    </div>
  </div>
</body>
</html>`}function Ae(t=""){return t.split(",").map(a=>a.trim()).filter(Boolean)}function me(t){var a,n,o="";if(typeof t=="string"||typeof t=="number")o+=t;else if(typeof t=="object")if(Array.isArray(t)){var r=t.length;for(a=0;a<r;a++)t[a]&&(n=me(t[a]))&&(o&&(o+=" "),o+=n)}else for(n in t)t[n]&&(o&&(o+=" "),o+=n);return o}function Re(){for(var t,a,n=0,o="",r=arguments.length;n<r;n++)(t=arguments[n])&&(a=me(t))&&(o&&(o+=" "),o+=a);return o}function P({children:t,variant:a="primary",onClick:n,disabled:o=!1,loading:r=!1,icon:l,iconPosition:i="left",className:u="",...d}){const p="inline-flex items-center justify-center gap-2 px-4 py-2 rounded-md text-sm font-medium transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-offset-2",g={primary:"bg-terra text-white hover:bg-terra-light focus:ring-terra-light disabled:opacity-50",outline:"border border-terra text-terra hover:bg-terra-light hover:text-black focus:ring-terra-light disabled:opacity-50",subtle:"bg-gray-700/70 text-gray-200 hover:bg-gray-700 focus:ring-gray-600 disabled:opacity-50",danger:"bg-danger text-white hover:bg-danger-hover focus:ring-red-600 disabled:opacity-70"};return e.jsxs("button",{onClick:n,disabled:o||r,className:Re(p,g[a],o&&"cursor-not-allowed",u),...d,children:[r&&e.jsx(he,{className:"animate-spin h-4 w-4 text-current"}),!r&&l&&i==="left"&&e.jsx(l,{className:"h-4 w-4"}),e.jsx("span",{children:t}),!r&&l&&i==="right"&&e.jsx(l,{className:"h-4 w-4"})]})}function R(){const t="hover:text-terra transition cursor-pointer underline-offset-4 hover:underline",a="text-terra font-semibold underline",{isSignedIn:n}=re(),o=Q(),[r,l]=m.useState(!1),[i,u]=m.useState(!1),d=m.useRef(null),p=m.useRef(n);m.useEffect(()=>{!p.current&&n&&(l(!1),o("/admin")),p.current=n},[n,o]),m.useEffect(()=>{function c(N){d.current&&!d.current.contains(N.target)&&u(!1)}return document.addEventListener("mousedown",c),()=>document.removeEventListener("mousedown",c)},[]),m.useEffect(()=>(r?document.body.style.overflow="hidden":document.body.style.overflow="",()=>{document.body.style.overflow=""}),[r]);const g=({isActive:c})=>`${t} ${c?a:"text-gray-300"}`;return e.jsxs("nav",{className:"w-full bg-neutral-800/70 backdrop-blur-sm border-b border-gray-800 py-3 px-4 text-gray-200",children:[e.jsxs("div",{className:"max-w-7xl mx-auto flex items-center justify-between",children:[e.jsx("div",{className:"text-2xl md:text-3xl font-bold font-mono text-terra",children:e.jsx(_,{to:"/",className:"hover:opacity-80 transition",children:"vectorThoughts"})}),e.jsxs("div",{className:"hidden md:flex gap-6 items-center text-lg font-mono",children:[e.jsx(_,{to:n?"/admin":"/",className:g,children:"Blog"}),e.jsx(_,{to:"/about",className:g,children:"About"}),e.jsxs("div",{className:"relative",ref:d,children:[e.jsx("button",{"aria-haspopup":"menu","aria-expanded":i,onClick:()=>u(c=>!c),className:"p-2 rounded hover:bg-neutral-700/40 transition",title:"Open menu",children:e.jsxs("svg",{width:"20",height:"14",viewBox:"0 0 20 14",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:"text-gray-200",children:[e.jsx("rect",{y:"0.5",width:"20",height:"2",rx:"1",fill:"currentColor"}),e.jsx("rect",{y:"6",width:"20",height:"2",rx:"1",fill:"currentColor"}),e.jsx("rect",{y:"11.5",width:"20",height:"2",rx:"1",fill:"currentColor"})]})}),e.jsx("div",{className:`origin-top-right absolute right-0 mt-2 w-52 rounded-md shadow-lg ring-1 ring-black ring-opacity-20 bg-neutral-900 z-50 transform transition-all ${i?"opacity-100 scale-100":"opacity-0 scale-95 pointer-events-none"}`,role:"menu","aria-hidden":!i,children:e.jsxs("div",{className:"py-1",children:[n?e.jsx("div",{className:"px-4 py-2",children:e.jsx(Z,{})}):e.jsx("div",{className:"px-4 py-2",children:e.jsx(X,{children:e.jsx(P,{variant:"primary",children:"Sign In"})})}),e.jsx(_,{to:"/request-admin",className:({isActive:c})=>`block px-4 py-2 text-sm ${t} ${c?a:"text-gray-300"}`,role:"menuitem",onClick:()=>u(!1),children:"Invite Link"}),e.jsx(_,{to:"/tags",className:({isActive:c})=>`block px-4 py-2 text-sm ${t} ${c?a:"text-gray-300"}`,role:"menuitem",onClick:()=>u(!1),children:"Tags"})]})})]})]}),e.jsx("div",{className:"md:hidden flex items-center",children:e.jsx("button",{onClick:()=>l(c=>!c),"aria-label":"Toggle menu","aria-expanded":r,className:"p-2 rounded hover:bg-neutral-700/40 transition",children:e.jsx("svg",{className:"w-6 h-6",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:r?e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"}):e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 6h16M4 12h16M4 18h16"})})})})]}),e.jsxs("div",{className:`md:hidden fixed inset-0 z-40 transform transition-transform ${r?"translate-x-0":"translate-x-full"} `,"aria-hidden":!r,children:[e.jsx("div",{className:"absolute inset-0 bg-black/50",onClick:()=>l(!1)}),e.jsxs("div",{className:"absolute right-0 top-0 h-full w-11/12 max-w-xs bg-neutral-900 shadow-xl p-6 overflow-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx(_,{to:"/",onClick:()=>l(!1),className:"text-xl font-bold text-terra",children:"vectorThoughts"}),e.jsx("button",{onClick:()=>l(!1),"aria-label":"Close menu",className:"p-2 rounded hover:bg-neutral-800/40",children:e.jsx("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("nav",{className:"flex flex-col gap-4",children:[e.jsx(_,{to:n?"/admin":"/",onClick:()=>l(!1),className:({isActive:c})=>`${t} ${c?a:"text-gray-300"}`,children:"Blog"}),e.jsx(_,{to:"/about",onClick:()=>l(!1),className:({isActive:c})=>`${t} ${c?a:"text-gray-300"}`,children:"About"}),e.jsxs("div",{className:"mt-4 border-t border-gray-800 pt-4",children:[n?e.jsx("div",{className:"mb-4",children:e.jsx(Z,{})}):e.jsx("div",{className:"mb-4",children:e.jsx(X,{children:e.jsx(P,{variant:"primary",children:"Sign In"})})}),e.jsx(_,{to:"/request-admin",onClick:()=>l(!1),className:({isActive:c})=>`block py-2 ${t} ${c?a:"text-gray-300"}`,children:"Invite Link"}),e.jsx(_,{to:"/tags",onClick:()=>l(!1),className:({isActive:c})=>`block py-2 ${t} ${c?a:"text-gray-300"}`,children:"Tags"})]})]})]})]})]})}function De(t){const{getToken:a}=ae(),n=ne(),o=J({queryKey:["post",t],queryFn:async({signal:i})=>_e({getToken:a,postId:t,signal:i}),enabled:!!t,staleTime:1e3*60*2,gcTime:1e3*60*10}),r=A({mutationFn:async i=>Pe({getToken:a,postId:t,payload:i}),onSuccess:i=>{n.setQueryData(["post",t],i)}}),l=A({mutationFn:async({formData:i,endpoint:u})=>Ie({getToken:a,formData:i,endpoint:u})});return{postQuery:o,saveMutation:r,uploadAssetMutation:l,queryClient:n}}const Te=m.lazy(()=>ge(()=>import("./SimpleEditor-Dcq-cYeD.js"),__vite__mapDeps([0,1,2,3,4,5])));function Be(){const t="https://vectorthoughts.xyz",a=Q(),{postId:n}=oe(),[o,r]=m.useState(""),[l,i]=m.useState(""),[u,d]=m.useState(null),[p,g]=m.useState(null),c=m.useRef(null),{postQuery:N,saveMutation:C,uploadAssetMutation:S}=De(n),{data:x,isLoading:$}=N,{register:w,handleSubmit:f,reset:E,control:T,watch:F}=fe({defaultValues:{title:"",slug:"",tagsText:"",summary:"",coverCaption:""}});m.useEffect(()=>{if(!x)return;const v=Array.isArray(x.tags)?x.tags.join(", "):"";if(E({title:x.title||"",slug:x.slug||"",tagsText:v,summary:x.summary||"",coverCaption:x.cover_caption||""}),x.raw&&r(x.raw),c.current&&(URL.revokeObjectURL(c.current),c.current=null),x.cover_asset_id){const j=new AbortController;return(async()=>{try{const k=await fetch(`${t}/api/assets/${x.cover_asset_id}`,{signal:j.signal});if(!k.ok){i(""),g(null);return}const L=await k.blob(),s=URL.createObjectURL(L);c.current=s,i(s),g({id:x.cover_asset_id,key:x.cover_image_key||null})}catch(k){k?.name,i(""),g(null)}})(),()=>{j.abort(),c.current&&(URL.revokeObjectURL(c.current),c.current=null)}}else i(""),g(null)},[x,E]);function W(v){const j=v?.target?.files?.[0];if(!j){l&&l.startsWith("blob:")&&URL.revokeObjectURL(l),d(null),i(""),g(null);return}l&&l.startsWith("blob:")&&URL.revokeObjectURL(l),d(j),i(URL.createObjectURL(j)),g(null)}function G(){l&&l.startsWith("blob:")&&URL.revokeObjectURL(l),d(null),i(""),g(null)}function O(v){return v?.id?`${t}/api/assets/${v.id}`:""}async function K(v,j){if(!u)return p||null;const k=new FormData;k.append("file",u,u.name),k.append("alt",`Cover image for ${v||"post"}`),k.append("caption",j&&j.trim()||v||""),n&&k.append("post_id",n);const L=await S.mutateAsync({formData:k,endpoint:`${t}/api/assets/upload-image`}),s=L.id||L.asset_id||L.assetId,h=L.link||L.public_link||L.url,b={id:s,link:h};return g(b),d(null),b}async function B(v){try{const j=v.title?.trim();let k=null;try{k=await K(j,v.coverCaption)}catch(h){console.error("Image upload failed:",h),alert("Cover image upload failed: "+(h.message||h))}const L=O(k||p),s={title:j,slug:v.slug?.trim()||ee(j),tags:Ae(v.tagsText),summary:v.summary?.trim(),raw:o,body:V(j,o,L,v.coverCaption,{hMargin:"5px",bgOpacity:.95}),status:"draft",...(k||p)?.id?{cover_asset_id:(k||p).id}:{}};await C.mutateAsync(s),console.log("Saved successfully")}catch(j){console.error("Save error:",j),alert("Error saving post: "+(j.message||j))}}async function H(v){try{await B(v);const j=new Date,k={day:"numeric",month:"long",year:"numeric"},L=j.toLocaleDateString("en-GB",k),s=O(p),h=V(v.title?.trim(),o,s,v.coverCaption,{hMargin:"5px",bgOpacity:.95},L),y=`${(v.slug?.trim()||ee(v.title||"")).replace(/\s+/g,"-").toLowerCase()}-post.html`,U=new Blob([h],{type:"text/html"}),M=new FormData;M.append("file",U,y),M.append("alt",`HTML snapshot for ${v.title||""}`),M.append("caption",v.title||v.coverCaption?.trim()||""),n&&M.append("post_id",n),await S.mutateAsync({formData:M,endpoint:`${t}/api/assets/html`}),a("/admin")}catch(j){console.error("Publish error:",j),alert("Error publishing post: "+(j.message||j))}}const z=F("title");return e.jsxs("div",{className:"bg-black/90",children:[e.jsx(R,{}),e.jsxs("div",{className:"max-w-5xl mx-auto my-10 px-4 text-gray-100",children:[e.jsx("h1",{className:"text-3xl font-extrabold font-mono text-gray-300 pb-2 mb-6 border-b border-gray-200",children:"Create A New Post"}),e.jsxs("form",{onSubmit:f(B),children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"title",className:"block text-sm font-medium text-gray-300 mb-1",children:"Title"}),e.jsx("input",{...w("title",{required:!0}),type:"text",id:"title",name:"title",className:"mt-1 block w-full px-3 py-2 border border-gray-300 placeholder-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-terra focus:border-terra sm:text-sm",placeholder:"Enter the post title"})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row sm:space-x-4 mb-6",children:[e.jsxs("div",{className:"w-full sm:w-1/2 mb-4 sm:mb-0",children:[e.jsx("label",{htmlFor:"slug",className:"block text-sm font-medium text-gray-300 mb-1",children:"Slug"}),e.jsx("input",{...w("slug"),type:"text",id:"slug",name:"slug",placeholder:"Enter-the-slug-(Optional)",className:"border mt-1 block w-full px-3 py-2 border-gray-300 placeholder-gray-300 rounded-md focus:outline-none focus:ring-terra focus:border-terra sm:text-sm"})]}),e.jsxs("div",{className:"w-full sm:w-1/2",children:[e.jsx("label",{htmlFor:"tags",className:"block text-sm font-medium text-gray-300 mb-1",children:"Tags"}),e.jsx("input",{...w("tagsText"),type:"text",id:"tagsText",name:"tagsText",placeholder:"eg. tag1, tag2",className:"mt-1 block w-full px-3 py-2 border border-gray-300 placeholder-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-terra focus:border-terra sm:text-sm"})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{htmlFor:"summary",className:"block text-sm font-medium text-gray-300 mb-1",children:"Summary"}),e.jsx("textarea",{...w("summary"),name:"summary",id:"summary",rows:3,placeholder:"Short Summary shown on Blog Cards",className:"mt-1 block w-full px-3 py-2 border border-gray-300 placeholder-gray-300 rounded-md focus:outline-none focus:ring-terra focus:border-terra sm:text-sm"})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{htmlFor:"coverImage",className:"block text-sm font-medium text-gray-300 mb-1",children:"Cover Image"}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("input",{type:"file",accept:"image/*",onChange:W}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(P,{onClick:G,variant:"danger",children:"Remove"}),e.jsx("span",{className:"text-sm text-gray-200",children:p?"Existing Cover Image Attached":u?u.name:"No Cover Image Attached"})]})]}),e.jsxs("div",{className:"mt-3",children:[e.jsx("label",{htmlFor:"coverCaption",className:"block text-sm font-medium text-gray-300 mb-1",children:"Cover Image Caption (optional — defaults to title if left empty)"}),e.jsx("input",{...w("coverCaption"),id:"coverCaption",type:"text",placeholder:"Caption for cover image",className:"mt-1 block w-full px-3 py-2 border border-gray-300 placeholder-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-terra focus:border-terra sm:text-sm"})]}),l&&e.jsxs("div",{className:"mt-4",children:[e.jsx("p",{className:"text-sm text-gray-300 mb-2",children:"Preview:"}),e.jsx("div",{className:"border rounded-lg overflow-hidden shadow-sm w-1/2",children:e.jsx("img",{src:l,alt:"Cover preview",className:"object-cover w-full h-40"})})]}),e.jsx("p",{className:"text-xs text-gray-400 mt-2",children:"Recommended: landscape images. Will show on blog card and post top."})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx(P,{type:"button",className:"ml-3",onClick:f(B),disabled:C.isLoading,variant:"primary",children:C.isLoading?"Creating...":"Create Post"}),n&&e.jsxs("span",{className:"ml-3 text-sm text-gray-400",children:["Post ID: ",n]})]})]}),e.jsx(m.Suspense,{fallback:e.jsx("div",{className:"text-sm text-gray-400",children:"Loading editor…"}),children:e.jsx(Te,{html:o,setHtml:r,postId:n})}),e.jsx("div",{className:"flex justify-start mt-4 gap-3",children:e.jsx(P,{onClick:f(B),disabled:C.isLoading,variant:"primary",children:C.isLoading?"Saving ...":"Save"})}),e.jsxs("div",{style:{marginTop:18},children:[e.jsx("strong",{children:"HTML output (preview)"}),e.jsx("div",{style:{border:"1px solid #ddd",padding:12,borderRadius:6,marginTop:8},children:e.jsx("div",{dangerouslySetInnerHTML:{__html:V((z||"").trim(),o,l,"This a test cover image",{hMargin:"5px",bgOpacity:.5})}})})]}),e.jsx("button",{onClick:f(H),disabled:S?.isLoading||C.isLoading,className:"bg-green-800 hover:bg-green-700 text-white mt-4 font-bold py-2 px-4 rounded-lg cursor-pointer transition duration-300 ease-in-out",children:S?.isLoading?"Publishing...":"Publish"})]})]})}function xe({isPublished:t,onToggle:a}){return e.jsx("button",{onClick:a,className:`px-3 py-1 rounded-md text-sm font-medium border transition-all duration-200
        ${t?"bg-[#1a1a1a] border-terra text-terra hover:bg-[#2a2a2a]":"bg-neutral-900 border-neutral-700 text-neutral-400 hover:bg-neutral-800 hover:text-terra-light"}`,children:t?"Published":"Draft"})}function Fe({post:t,onOpen:a,onToggleStatus:n,onDelete:o,onEdit:r}){const l="https://vectorthoughts.xyz",[i,u]=m.useState(!1),d=m.useRef(null),p=m.useRef(null),[g,c]=m.useState(!0),N="h-44";function C(){return t?.cover_asset_id?`${l}/api/assets/${t.cover_asset_id}`:null}const S=C();return m.useEffect(()=>{function x($){d.current&&!d.current.contains($.target)&&u(!1)}return i&&document.addEventListener("mousedown",x),()=>{document.removeEventListener("mousedown",x)}},[i]),m.useEffect(()=>{if(!i||!p.current)return;const x=p.current.getBoundingClientRect(),$=window.innerHeight,w=120,f=x.top,E=$-x.bottom;c(f>=w+8||f>E)},[i]),t.deleted?null:e.jsx("article",{className:`bg-neutral-800/70 shadow-xl p-0 overflow-hidden w-full max-w-6xl mx-auto rounded-md ${N}`,role:"article",children:e.jsxs("div",{className:"flex h-full",children:[e.jsxs("div",{className:"w-2/3 pr-4 flex flex-col justify-between p-4",children:[e.jsxs("div",{onClick:a,role:"link",tabIndex:0,children:[e.jsx("h3",{className:"text-lg font-semibold font-roboto mb-1 hover:cursor-pointer hover:underline hover:underline-offset-4 hover:text-terra-dark",children:t.title}),e.jsx("p",{className:"text-xs text-gray-500 mb-1",children:new Date(t.created_at).toLocaleDateString("en-IN",{day:"2-digit",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"})}),e.jsx("p",{className:"text-gray-300 text-sm line-clamp-2",children:t.summary})]}),e.jsxs("div",{className:"flex items-center justify-between mt-4",children:[e.jsx("div",{children:e.jsx(xe,{isPublished:t.status==="published",onToggle:()=>n(t.id)})}),e.jsxs("div",{className:"relative",ref:d,children:[e.jsxs("button",{ref:p,onClick:()=>u(x=>!x),className:"p-1 rounded-md hover:bg-neutral-800 transition text-gray-300","aria-haspopup":"true","aria-expanded":i,children:[e.jsx(le,{className:"w-5 h-5"}),e.jsx("span",{className:"sr-only",children:"Open actions menu"})]}),i&&e.jsxs("div",{className:`absolute right-0 z-30 w-40 bg-neutral-900 border border-neutral-700 rounded-md shadow-lg origin-top-right transform ${g?"bottom-full mb-2":"top-full mt-2"}`,children:[g?e.jsx("div",{className:"absolute right-3 -bottom-1 w-3 h-3 bg-neutral-900 rotate-45 border border-neutral-700"}):e.jsx("div",{className:"absolute right-3 -top-1 w-3 h-3 bg-neutral-900 rotate-45 border border-neutral-700"}),e.jsxs("div",{className:"py-1",children:[e.jsxs("button",{onClick:()=>{u(!1),r(t.id)},className:"w-full text-left px-3 py-2 text-sm hover:bg-neutral-800 flex items-center gap-2",children:[e.jsx(ie,{className:"w-4 h-4 text-gray-300"}),e.jsx("span",{className:"text-gray-200",children:"Edit"})]}),e.jsxs("button",{onClick:()=>{u(!1),o(t.id)},className:"w-full text-left px-3 py-2 text-sm hover:bg-neutral-800 flex items-center gap-2",children:[e.jsx(ce,{className:"w-4 h-4 text-red-400"}),e.jsx("span",{className:"text-red-300",children:"Delete"})]})]})]})]})]})]}),e.jsx("div",{onClick:a,role:"link",tabIndex:0,className:`w-1/3 flex-shrink-0 ${N} overflow-hidden`,children:e.jsx("img",{src:S||"/src/assets/img1.jpg",alt:t?.cover_image?.alt||"Cover Image",className:"w-full h-full object-cover hover:cursor-pointer"})})]})})}function Ue({showDeleted:t,setShowDeleted:a,deletedCount:n}){return e.jsxs("label",{className:"flex items-center gap-2 bg-neutral-900 border border-neutral-700 rounded-md px-3 py-1 cursor-pointer text-sm select-none hover:bg-neutral-800 transition",onClick:()=>a(!t),children:[e.jsx("div",{className:`w-4 h-4 rounded-sm flex items-center justify-center border transition-colors
        ${t?"bg-[#da7756] border-[#da7756]":"bg-neutral-800 border-neutral-600"}`,children:t&&e.jsx(pe,{className:"w-3 h-3 text-black"})}),e.jsxs("span",{className:"text-gray-300",children:["Show Deleted ",e.jsxs("span",{className:"text-gray-500",children:["(",n,")"]})]})]})}function Me({post:t,onOpen:a,onToggleStatus:n,onDelete:o,onEdit:r}){const l="https://vectorthoughts.xyz",[i,u]=m.useState(!1),d=m.useRef(null),p=m.useRef(null),[g,c]=m.useState(!0),N="h-60";function C(){return t?.cover_asset_id?`${l}/api/assets/${t.cover_asset_id}`:null}const S=C();return m.useEffect(()=>{function x($){d.current&&!d.current.contains($.target)&&u(!1)}return i&&document.addEventListener("mousedown",x),()=>{document.removeEventListener("mousedown",x)}},[i]),m.useEffect(()=>{if(!i||!p.current)return;const x=p.current.getBoundingClientRect(),$=window.innerHeight,w=120,f=x.top,E=$-x.bottom;c(f>=w+8||f>E)},[i]),t.deleted?null:e.jsx("article",{className:`bg-neutral-800/70 shadow-xl p-0 overflow-hidden w-full max-w-6xl mx-auto rounded-md ${N}`,role:"article",children:e.jsxs("div",{className:"flex h-full",children:[e.jsx("div",{onClick:a,role:"link",tabIndex:0,className:`w-1/3 flex-shrink-0 ${N} overflow-hidden`,children:e.jsx("img",{src:S||"/src/assets/img1.jpg",alt:t?.cover_image?.alt||"Cover Image",className:"w-full h-full object-cover hover:cursor-pointer"})}),e.jsxs("div",{className:"w-2/3 pl-10 flex flex-col justify-between p-4",children:[e.jsxs("div",{onClick:a,role:"link",tabIndex:0,children:[e.jsx("h3",{className:"text-[23px] justify-end font-roboto font-semibold mb-1 hover:cursor-pointer hover:underline hover:underline-offset-4 hover:text-terra-dark",children:t.title}),e.jsx("p",{className:"text-[16px] text-gray-500 mb-1",children:new Date(t.created_at).toLocaleDateString("en-IN",{day:"2-digit",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"})}),e.jsx("p",{className:"text-gray-300 text-[19px] line-clamp-2",children:t.summary})]}),e.jsxs("div",{className:"flex items-center justify-between mt-4",children:[e.jsx("div",{children:e.jsx(xe,{isPublished:t.status==="published",onToggle:()=>n(t.id)})}),e.jsxs("div",{className:"relative",ref:d,children:[e.jsxs("button",{ref:p,onClick:()=>u(x=>!x),className:"p-1 rounded-md hover:bg-neutral-800 transition text-gray-300","aria-haspopup":"true","aria-expanded":i,children:[e.jsx(le,{className:"w-5 h-5"}),e.jsx("span",{className:"sr-only",children:"Open actions menu"})]}),i&&e.jsxs("div",{className:`absolute right-0 z-30 w-40 bg-neutral-900 border border-neutral-700 rounded-md shadow-lg origin-top-right transform ${g?"bottom-full mb-2":"top-full mt-2"}`,children:[g?e.jsx("div",{className:"absolute right-3 -bottom-1 w-3 h-3 bg-neutral-900 rotate-45 border border-neutral-700"}):e.jsx("div",{className:"absolute right-3 -top-1 w-3 h-3 bg-neutral-900 rotate-45 border border-neutral-700"}),e.jsxs("div",{className:"py-1",children:[e.jsxs("button",{onClick:()=>{u(!1),r(t.id)},className:"w-full text-left px-3 py-2 text-sm hover:bg-neutral-800 flex items-center gap-2",children:[e.jsx(ie,{className:"w-4 h-4 text-gray-300"}),e.jsx("span",{className:"text-gray-200",children:"Edit"})]}),e.jsxs("button",{onClick:()=>{u(!1),o(t.id)},className:"w-full text-left px-3 py-2 text-sm hover:bg-neutral-800 flex items-center gap-2",children:[e.jsx(ce,{className:"w-4 h-4 text-red-400"}),e.jsx("span",{className:"text-red-300",children:"Delete"})]})]})]})]})]})]})]})})}async function D(t,a,n={}){const r={"Content-Type":"application/json",Authorization:`Bearer ${await t()}`,...n.headers||{}},l=await fetch(a,{...n,headers:r});if(!l.ok){const u=(await l.json().catch(()=>null))?.detail||await l.text().catch(()=>null)||l.statusText,d=new Error(`HTTP ${l.status}: ${u}`);throw d.status=l.status,d.response=l,d}return l.status===204?null:l.json().catch(()=>null)}async function Oe({getToken:t,backendUrl:a,limit:n=50,skip:o=0,showDeleted:r=!1}){const l=`${a}/api/posts?limit=${n}&skip=${o}${r?"&show_deleted=1":""}`;return D(t,l)}async function He({getToken:t,backendUrl:a,id:n}){const o=`${a}/api/posts/${encodeURIComponent(n)}`;return D(t,o)}async function ze({getToken:t,backendUrl:a}){const n=`${a}/api/posts`;return D(t,n,{method:"POST"})}async function qe({getToken:t,backendUrl:a,id:n,status:o}){const r=`${a}/api/posts/${n}/status?status=${encodeURIComponent(o)}`;return D(t,r,{method:"PATCH"})}async function Qe({getToken:t,backendUrl:a,id:n}){const o=`${a}/api/posts/${n}/delete`;return D(t,o,{method:"PATCH"})}async function We({getToken:t,backendUrl:a,id:n}){const o=`${a}/api/posts/${n}/restore`;return D(t,o,{method:"PATCH"})}async function Ge({getToken:t,backendUrl:a,id:n}){const o=`${a}/api/posts/${n}/delete`;return D(t,o,{method:"DELETE"})}function Ke(){const{getToken:t}=ae(),a="https://vectorthoughts.xyz",n=Q(),o=ne(),[r,l]=m.useState(!1),[i,u]=m.useState(new Set),[d,p]=m.useState(new Set),g=(s,h)=>u(b=>{const y=new Set(b);return h?y.add(s):y.delete(s),y}),c=(s,h)=>p(b=>{const y=new Set(b);return h?y.add(s):y.delete(s),y}),{data:N=[],isLoading:C,isError:S,error:x}=J({queryKey:["posts",{showDeleted:r}],queryFn:async()=>Oe({getToken:t,backendUrl:a,limit:20,skip:0,showDeleted:r}),staleTime:1e3*30,gcTime:1e3*60*10});S&&(console.error("Error fetching posts",x),alert("Error fetching posts: "+(x.message||x)));const $=m.useMemo(()=>N.filter(s=>r?!0:!s.is_deleted),[N,r]),w=m.useMemo(()=>N.filter(s=>s.is_deleted).length,[N]),f=$.length>0?$[0]:null,E=$.length>1?$.slice(1):[],{mutate:T,isLoading:F}=A({mutationFn:()=>ze({getToken:t,backendUrl:a}),onSuccess:s=>{const h=s?.id||s?.post_id;o.invalidateQueries(["posts"]),h&&n(`/admin/publish/${h}`)},onError:s=>{console.error("Create post failed:",s),alert("Error creating new post: "+(s.message||s))}}),{mutate:W}=A({mutationFn:({id:s,newStatus:h})=>qe({getToken:t,backendUrl:a,id:s,status:h}),onMutate:async({id:s,newStatus:h})=>{await o.cancelQueries(["posts",{showDeleted:r}]);const b=o.getQueryData(["posts",{showDeleted:r}]);return o.setQueryData(["posts",{showDeleted:r}],(y=[])=>y.map(U=>U.id===s?{...U,status:h}:U)),g(s,!0),{previous:b,id:s}},onError:(s,h,b)=>{console.error("Toggle status failed:",s),alert("Failed to toggle status: "+(s.message||s)),o.setQueryData(["posts",{showDeleted:r}],b.previous)},onSettled:(s,h,b,y)=>{g(y?.id,!1),o.invalidateQueries(["posts",{showDeleted:r}])}}),{mutate:G}=A({mutationFn:({id:s})=>Qe({getToken:t,backendUrl:a,id:s}),onMutate:async({id:s})=>{await o.cancelQueries(["posts",{showDeleted:r}]);const h=o.getQueryData(["posts",{showDeleted:r}]);return o.setQueryData(["posts",{showDeleted:r}],(b=[])=>b.map(y=>y.id===s?{...y,is_deleted:!0}:y)),g(s,!0),{previous:h,id:s}},onError:(s,h,b)=>{console.error("Soft delete failed:",s),alert("Failed to soft delete: "+(s.message||s)),o.setQueryData(["posts",{showDeleted:r}],b.previous)},onSettled:(s,h,b,y)=>{g(y?.id,!1),o.invalidateQueries(["posts",{showDeleted:r}])}}),{mutate:O}=A({mutationFn:({id:s})=>We({getToken:t,backendUrl:a,id:s}),onMutate:async({id:s})=>{await o.cancelQueries(["posts",{showDeleted:r}]);const h=o.getQueryData(["posts",{showDeleted:r}]);return o.setQueryData(["posts",{showDeleted:r}],(b=[])=>b.map(y=>y.id===s?{...y,is_deleted:!1}:y)),g(s,!0),{previous:h,id:s}},onError:(s,h,b)=>{console.error("Restore failed:",s),alert("Failed to restore: "+(s.message||s)),o.setQueryData(["posts",{showDeleted:r}],b.previous)},onSettled:(s,h,b,y)=>{g(y?.id,!1),o.invalidateQueries(["posts",{showDeleted:r}])}}),{mutate:K}=A({mutationFn:({id:s})=>Ge({getToken:t,backendUrl:a,id:s}),onMutate:({id:s})=>{c(s,!0)},onSuccess:(s,{id:h})=>{o.setQueryData(["posts",{showDeleted:r}],(b=[])=>b.filter(y=>y.id!==h))},onError:(s,h)=>{console.error("Permanent delete failed:",s),alert("Failed to permanently delete post: "+(s.message||s))},onSettled:(s,h,b)=>{c(b?.id,!1),o.invalidateQueries(["posts",{showDeleted:r}])}}),B=s=>{o.prefetchQuery({queryKey:["post",s],queryFn:()=>He({getToken:t,backendUrl:a,id:s}),staleTime:1e3*60*5})};function H(s){const h=N.find(y=>y.id===s);if(!h)return;const b=h.status==="published"?"draft":"published";W({id:s,newStatus:b})}function z(s){G({id:s})}function v(s){O({id:s})}function j(s){window.confirm("This will permanently delete the post. Click ok to continue")&&K({id:s})}function k(s){const h=s.slug,b=s.html_asset_id;n(`/article/${h}`,{state:{postId:s.id,assetId:b}})}function L(s){B(s),n(`/admin/publish/${s}`)}return e.jsxs("div",{className:"min-h-screen bg-black/95 text-gray-300",children:[e.jsx(R,{}),e.jsxs("div",{className:"max-w-6xl mx-auto p-6 flex flex-col gap-6",children:[e.jsxs("header",{className:"flex items-center justify-between",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Admin-Dashboard"}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(P,{onClick:T,loading:F,variant:"outline",icon:be,children:"New Post"}),e.jsx(Ue,{showDeleted:r,setShowDeleted:l,deletedCount:w})]})]}),C?e.jsxs(e.Fragment,{children:[e.jsx(q,{size:"60",bgOpacity:"0.1",speed:"1.4",color:"#da7756"}),e.jsx("p",{className:"text-gray-300 text-sm tracking-wide",children:"Loading Posts"})]}):$.length===0?e.jsx("div",{className:"text-center text-gray-500 py-12",children:"No posts yet. Create one."}):e.jsxs(e.Fragment,{children:[f&&e.jsx("section",{className:"flex flex-col gap-4",children:f.is_deleted?e.jsxs("div",{className:"bg-neutral-800/60 border border-neutral-700/60 rounded-md p-4 flex items-center justify-between shadow-md hover:shadow-lg hover:bg-neutral-800/80 transition-all duration-200",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h3",{className:"font-semibold text-gray-200 text-base",children:f.title}),e.jsx("span",{className:"text-xs px-2 py-0.5 rounded-full bg-red-500/20 text-red-400 border border-red-400/30 uppercase tracking-wide",children:"Deleted"})]}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:new Date(f.date).toLocaleDateString("en-IN",{day:"2-digit",month:"short",year:"numeric"})})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>v(f.id),disabled:i.has(f.id),className:`px-3 py-1.5 rounded-md text-sm font-medium transition-all ${i.has(f.id)?"bg-neutral-700 text-gray-400 cursor-not-allowed":"bg-green-600/20 text-green-400 hover:bg-green-600/30 hover:text-green-300"}`,children:i.has(f.id)?"Restoring…":"Restore"}),e.jsx("button",{onClick:()=>j(f.id),disabled:d.has(f.id),className:`px-3 py-1.5 rounded-md text-sm font-medium transition-all ${d.has(f.id)?"bg-neutral-700 text-gray-400 cursor-not-allowed":"bg-red-600/20 text-red-400 hover:bg-red-600/30 hover:text-red-300"}`,children:d.has(f.id)?"Deleting…":"Delete Permanently"})]})]}):e.jsx(Me,{post:f,onOpen:()=>k(f),onToggleStatus:()=>H(f.id),onDelete:()=>z(f.id),onEdit:()=>L(f.id)})}),e.jsx("section",{className:"flex flex-col gap-4 mt-6",children:E.map(s=>s.is_deleted?e.jsxs("div",{className:"bg-neutral-800/60 border border-neutral-700/60 rounded-md p-4 flex items-center justify-between shadow-md hover:shadow-lg hover:bg-neutral-800/80 transition-all duration-200",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h3",{className:"font-semibold text-gray-200 text-base",children:s.title}),e.jsx("span",{className:"text-xs px-2 py-0.5 rounded-full bg-red-500/20 text-red-400 border border-red-400/30 uppercase tracking-wide",children:"Deleted"})]}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:new Date(s.date).toLocaleDateString("en-IN",{day:"2-digit",month:"short",year:"numeric"})})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>v(s.id),disabled:i.has(s.id),className:`px-3 py-1.5 rounded-md text-sm font-medium transition-all ${i.has(s.id)?"bg-neutral-700 text-gray-400 cursor-not-allowed":"bg-green-600/20 text-green-400 hover:bg-green-600/30 hover:text-green-300"}`,children:i.has(s.id)?"Restoring…":"Restore"}),e.jsx("button",{onClick:()=>j(s.id),disabled:d.has(s.id),className:`px-3 py-1.5 rounded-md text-sm font-medium transition-all ${d.has(s.id)?"bg-neutral-700 text-gray-400 cursor-not-allowed":"bg-red-600/20 text-red-400 hover:bg-red-600/30 hover:text-red-300"}`,children:d.has(s.id)?"Deleting…":"Delete Permanently"})]})]},s.id):e.jsx(Fe,{post:s,onOpen:()=>k(s),onToggleStatus:()=>H(s.id),onDelete:()=>z(s.id),onEdit:()=>L(s.id)},s.id))})]})]})]})}const te="https://vectorthoughts.xyz";function Ve(){const{slug:t}=oe(),a=ye(),{postId:n,assetId:o}=a.state||{},r=async({signal:p})=>{if(!n||!o)throw new d("Missing Post Ids");const g=`${te}/api/assets/${o}`,c=await fetch(g,{method:"GET",headers:{Accept:"text/html"},signal:p});if(!c.ok){const S=await c.text().catch(()=>"");throw new Error(`HTML fetch failed: ${c.status} ${S}`)}const N=await c.text();return`<base href="${`${te}/api/assets/${o}`}">${N}`},{data:l,isLoading:i,isError:u,error:d}=J({queryKey:["publicPosts",t],queryFn:r,enabled:!!t,staleTime:0,gcTime:1e3*60,refetchOnMount:"always",refetchOnWindowFocus:!1});if(i)return e.jsxs("div",{className:"flex flex-col items-center gap-3 mt-50",children:[e.jsx(q,{size:"60",bgOpacity:"0.1",speed:"1.4",color:"#da7756"}),e.jsx("p",{className:"text-black text-sm tracking-wide",children:"Loading Post..."})]});if(u){const p=d instanceof Error?d.message:String(d);return e.jsxs("div",{className:"blog-error",children:["Error: ",p]})}return e.jsx("div",{className:"blog-content",dangerouslySetInnerHTML:{__html:l||"<p>No content</p>"}})}function Je(){return e.jsxs("div",{className:"min-h-screen bg-neutral-900 text-gray-900",children:[e.jsx(R,{}),e.jsx("div",{className:"max-w-2xl mx-auto p-6",children:e.jsx("h3",{className:"text-3xl text-center font-extrabold font-mono text-gray-300 pb-2 mb-6 border-b border-gray-200",children:" About Page Upcoming"})})]})}function Ye(){return e.jsxs("div",{className:"min-h-screen bg-neutral-900 text-gray-900",children:[e.jsx(R,{}),e.jsx("div",{className:"max-w-2xl mx-auto p-6",children:e.jsx("h3",{className:"text-3xl text-center font-extrabold font-mono text-gray-300 pb-2 mb-6 border-b border-gray-200",children:" Tags Page Upcoming"})})]})}function Ze(){const[t,a]=m.useState({name:"",email:"",portfolio:""}),[n,o]=m.useState(!1),[r,l]=m.useState(""),[i,u]=m.useState("");function d(g){a(c=>({...c,[g.target.name]:g.target.value}))}async function p(g){if(g.preventDefault(),u(null),l(null),!t.name.trim()||!t.email.trim()){u("Name and Email are required");return}o(!0);try{const c=await fetch("/api/request-admin",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}),N=await c.json();if(!c.ok){const C=await c.text();throw new i(`Failed to submit request: ${text}`)}a({name:"",email:"",portfolio:""})}catch(c){u(c.message)}finally{o(!1)}}return e.jsx("div",{className:"bg-neutral-900/95 w-full min-h-screen",children:e.jsxs("div",{className:"max-w-2xl mx-auto p-6",children:[e.jsx("h1",{className:"text-3xl font-extrabold font-mono text-gray-300 pb-2 mb-6 border-b border-gray-200",children:"If you want to contribute to the Blog"}),e.jsxs("form",{onSubmit:p,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Full name"}),e.jsx("input",{name:"name",value:t.name,onChange:d,className:"border mt-1 block w-full px-3 py-2 border-gray-300 placeholder-gray-300 rounded-md focus:outline-none focus:ring-terra focus:border-terra sm:text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Email"}),e.jsx("input",{name:"email",value:t.email,onChange:d,type:"email",className:"border mt-1 block w-full px-3 py-2 border-gray-300 placeholder-gray-300 rounded-md focus:outline-none focus:ring-terra focus:border-terra sm:text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-1",children:"Portfolio / relevant links (optional)"}),e.jsx("input",{name:"portfolio",value:t.portfolio,onChange:d,className:"border mt-1 block w-full px-3 py-2 border-gray-300 placeholder-gray-300 rounded-md focus:outline-none focus:ring-terra focus:border-terra sm:text-sm"})]}),e.jsxs("div",{children:[e.jsx(P,{type:"submit",disabled:n,variant:"primary",children:n?"Submitting...":"Submit Request"}),r&&e.jsx("span",{className:"text-green-400 px-2",children:r}),i&&e.jsx("span",{className:"text-red-400 px-2",children:i})]})]})]})})}function Xe({post:t,onOpen:a}){const n="h-42",o="https://vectorthoughts.xyz";function r(){return t?.cover_asset_id?`${o}/api/assets/${t.cover_asset_id}`:null}return e.jsx("article",{className:`bg-neutral-800/70 shadow-xl p-0 overflow-hidden w-full max-w-6xl mx-auto rounded-md ${n}`,role:"article",children:e.jsxs("div",{className:"flex h-full",children:[e.jsx("div",{className:"w-2/3 pr-4 flex flex-col justify-between p-4",children:e.jsxs("div",{onClick:a,role:"link",tabIndex:0,children:[e.jsx("h3",{className:"text-lg font-semibold font-roboto mb-1 hover:cursor-pointer hover:underline hover:underline-offset-4 hover:text-terra-dark",children:t.title}),e.jsx("p",{className:"text-xs text-gray-500 mb-2",children:new Date(t.created_at).toLocaleDateString("en-IN",{day:"2-digit",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"})}),e.jsx("p",{className:"text-gray-300 text-sm line-clamp-3",children:t.summary})]})}),e.jsx("div",{onClick:a,role:"link",tabIndex:0,className:`w-1/3 flex-shrink-0 ${n} overflow-hidden`,children:e.jsx("img",{src:r(),alt:t?.cover_image?.alt||"Cover Image",className:"w-full h-full object-cover hover:cursor-pointer"})})]})})}function et({post:t,onOpen:a}){const n="h-60",o="https://vectorthoughts.xyz";function r(){return t?.cover_asset_id?`${o}/api/assets/${t.cover_asset_id}`:null}return e.jsx("article",{className:`bg-neutral-800/70 shadow-xl p-0 overflow-hidden w-full max-w-6xl mx-auto rounded-md ${n}`,role:"article",children:e.jsxs("div",{className:"flex h-full",children:[e.jsx("div",{onClick:a,role:"link",tabIndex:0,className:`w-1/3 flex-shrink-0 ${n} overflow-hidden`,children:e.jsx("img",{src:r(),alt:t?.cover_image?.alt||"Cover Image",className:"w-full h-full object-cover hover:cursor-pointer"})}),e.jsx("div",{className:"w-2/3 pl-10 flex flex-col justify-between p-4",children:e.jsxs("div",{onClick:a,role:"link",tabIndex:0,children:[e.jsxs("h3",{className:"text-[23px] justify-end font-roboto font-semibold mb-1 hover:cursor-pointer hover:underline hover:underline-offset-4 hover:text-terra-dark",children:[e.jsx("span",{className:"text-terra text-xs p-1 rounded-md mr-3 bg-orange-200/10",children:"Recent"}),t.title]}),e.jsx("p",{className:"text-[16px] text-gray-500 mb-1",children:new Date(t.created_at).toLocaleDateString("en-IN",{day:"2-digit",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"})}),e.jsx("p",{className:"text-gray-300 text-[19px] line-clamp-2",children:t.summary})]})})]})})}const tt="https://vectorthoughts.xyz";function st(){const t=Q(),a=10,n=async({pageParam:w=0,signal:f})=>{const E=`${tt}/api/public/posts?limit=${a}&skip=${w}`,T=await fetch(E,{method:"GET",signal:f});if(!T.ok){const F=await T.text();throw new Error(`Posts Loading error: ${F}`)}return T.json()},{data:o,isLoading:r,isError:l,error:i,fetchNextPage:u,hasNextPage:d,isFetchingNextPage:p,refetch:g}=ve({queryKey:["publicPosts"],queryFn:n,getNextPageParam:(w,f)=>{if(Array.isArray(w)&&w.length===a)return f.length*a},staleTime:1e3*60*1}),{ref:c,inView:N}=je();if(m.useEffect(()=>{N&&d&&!p&&u()},[u,N,d,p]),r)return e.jsxs("div",{className:"min-h-screen bg-black/95 text-gray-300",children:[e.jsx(R,{}),e.jsx("div",{className:"max-w-6xl mx-auto p-6 flex flex-col gap-7 mt-5",children:e.jsx("section",{className:"flex flex-col gap-4",children:e.jsxs("div",{className:"flex flex-col items-center justify-center py-16 gap-4 mt-60",children:[e.jsx(q,{size:"60",bgOpacity:"0.1",speed:"1.4",color:"#da7756"}),e.jsx("p",{className:"text-gray-300 text-sm tracking-wide",children:"Loading Posts"})]})})})]});if(l)return console.error("Error fetching posts:",i),i instanceof Error?i.message:str(i),e.jsxs("div",{className:"min-h-screen bg-black/95 text-gray-300",children:[e.jsx(R,{}),e.jsxs("div",{className:"max-w-6xl mx-auto p-6 flex flex-col gap-7 mt-5",children:[e.jsxs("div",{className:"blog-error",children:["Error fetching posts: ",msg]}),e.jsx("div",{children:e.jsx(P,{onClick:()=>g(),variant:"primary",children:"Retry"})})]})]});function C(w){const f=w.slug,E=w.html_asset_id;t(`/article/${f}`,{state:{postId:w.id,assetId:E}})}const S=o?.pages?.flat()||[],x=S.length>0?S[0]:null,$=S.slice(1);return e.jsxs("div",{className:"min-h-screen bg-black/95 text-gray-300",children:[e.jsx(R,{}),e.jsx("div",{className:"max-w-6xl mx-auto p-6 flex flex-col gap-7 mt-5",children:e.jsxs("section",{className:"flex flex-col gap-4",children:[S.length===0&&e.jsxs("div",{className:"flex flex-col items-center justify-center py-16 gap-4",children:[e.jsx(we,{size:"70",speed:"1.75",color:"#da7756"}),e.jsx("p",{className:"text-gray-300 text-sm tracking-wide",children:"No posts yet"})]}),x&&e.jsx("section",{className:"flex flex-col gap-4",children:e.jsx(et,{post:x,onOpen:()=>C(x)})}),e.jsx("section",{className:"flex flex-col gap-4 mt-6",children:$.map(w=>e.jsx(Xe,{post:w,onOpen:()=>C(w)},w.id))}),e.jsx("div",{className:"flex flex-col items-center gap-3 mt-6",children:p?e.jsxs("div",{children:[e.jsx(q,{size:"40",bgOpacity:"0.1",speed:"1.2",color:"#da7756"}),e.jsx("p",{className:"text-sm text-gray-300",children:"Loading more…"})]}):d?e.jsxs(e.Fragment,{children:[e.jsx("div",{ref:c}),e.jsx(P,{onClick:()=>u(),variant:"primary",children:"Load More"})]}):e.jsx("p",{className:"text-sm text-gray-400",children:"No more posts"})})]})})]})}function se({children:t}){const{isSignedIn:a,user:n}=re(),[o,r]=m.useState(!0),[l,i]=m.useState(!1);return m.useEffect(()=>{if(typeof a=="boolean"){if(!a){i(!1),r(!1);return}n&&n.id==="user_34CM89upzwvwrDbBxOVJGdxT8FW"?i(!0):i(!1),r(!1)}},[a,n]),o?e.jsx("div",{children:"Loading..."}):l?e.jsx(e.Fragment,{children:t}):e.jsx(de,{to:"/",replace:!0})}function rt(){return e.jsx(Ne,{basename:"/vectorthoughts",children:e.jsxs(ke,{children:[e.jsx(I,{path:"/",element:e.jsx(st,{})}),e.jsx(I,{path:"/about",element:e.jsx(Je,{})}),e.jsx(I,{path:"/tags",element:e.jsx(Ye,{})}),e.jsx(I,{path:"/article/:slug",element:e.jsx(Ve,{})}),e.jsx(I,{path:"/request-admin",element:e.jsx(Ze,{})}),e.jsx(I,{path:"/admin/publish/:postId",element:e.jsx(se,{children:e.jsx(Be,{})})}),e.jsx(I,{path:"/admin",element:e.jsx(se,{children:e.jsx(Ke,{})})}),e.jsx(I,{path:"*",element:e.jsx(de,{to:"/",replace:!0})})]})})}const at=new Ce,nt="pk_test_bWFueS1ib25lZmlzaC0zNy5jbGVyay5hY2NvdW50cy5kZXYk";Se.createRoot(document.getElementById("root")).render(e.jsx(m.StrictMode,{children:e.jsx($e,{publishableKey:nt,children:e.jsxs(Le,{client:at,children:[e.jsx(rt,{}),e.jsx(Ee,{initialIsOpen:!1})]})})}));
